<?php defined('BASEPATH') OR exit('No direct script access allowed');
require APPPATH . '/libraries/BaseController.php';
date_default_timezone_set('Asia/Kolkata');
class Excel_uploads extends BaseController
{
	function __construct()
    {
        parent::__construct();
        $this->isAdminLoggedIn();
        $this->load->model('Common_model');
        $this->load->helper('form');
    }

    public function import_leads_partners()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    // 	pre($upload_data);
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$password = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$ifsc = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$accouunt_no = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$ac_holder = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$bank_branch = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$bank_name = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$aadhar = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$pan = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$alt_mobile = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$landline = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$contact = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        		
					$data = array(
					    'name'=> $name,
					    'email'=> $email,
						'phone'=> $phone,
						'password'=>$password,
						'ifsc'=> $ifsc,
						'account_no'=> $accouunt_no,
						'ac_holder'=> $ac_holder,
						'bank_branch' =>$bank_branch,
						'bank_name' =>$bank_name,
						'aadhar'=> $aadhar,
						'pan'=> $pan,
						'alt_mobile'=> $alt_mobile,
						'address'=> $address,
						'landline'=> $landline,
						'contact'=> $contact,
					);
                    if(!empty($name)){
    				$this->Common_model->insert_data('lead_partners',$data);
                    }
       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('backend/lead_partners');
    }
    
    function buyers_leads()
    {
        $form_data = $this->input->post(array('res_com', 'buy_rent', 'residential'));
        if($form_data['res_com'] == "Residential")
        {
            if($form_data['buy_rent'] == "buy")
            {
                if($form_data['residential'] == "Flat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id' => $lead_partner_id,
                                                     'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Flat',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $duplex_flat = array(
                                                 'post_id'=>$result,
                                                 'Room'=> $rooms,
                                                 'Bathroom'=> $bathrooms,
                                                 'FlatMinimumAreaRequired'=> $min_area,
                                                 'SuperBuildupAreaUnit'=> $min_area_unit,
                                                 'FlatMaximumAreaRequired'=> $max_area,
                                                 'BuildupAreaUnit'=> $max_area_unit,
                                                 'MinimumFloorHeight'=>$min_floor_hights,
                                                 'MaximumFloorHeight'=>$max_floor_hights,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupUnit'=>$supper_b_unit,
                                                 'BuildupArea'=>$bulid_up,
                                                 'BuildupUnit'=>$build_up_unit,
                                                 'CarpetArea'=>$carpet_area,
                                                 'CarpetAreaUnit'=>$carpet_area_unit,
                                                 'balcony'=>$balcony,
                                                 'kitchen'=>$kitchen,
                                                 'totalfloor'=>$total_floor,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                                }
            		        }
                		}
                	}
                }
                
                if($form_data['residential'] == "HouseorBanglow")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$total_area = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$total_area_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$total_uncovered_unit = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=> $lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'HouseOrBanglow',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $house = array(
                                         'post_id'=>$result,
                                         'HouseRoom'=> $rooms,
                                         'HouseBathroom'=> $bathrooms,
                                         'SuperBuildupArea'=> $supper_buildup,
                                         'SuperBuildupAreaUnit'=> $supper_b_unit,
                                         'MinimumAreaRequired'=> $min_area,
                                         'StockMinimumAreaRequiredUnit'=>$min_area_unit,
                                         'HouseMaximumAreaRequired'=> $max_area,
                                         'HouseMaximumOpenAreaUnit'=> $max_area_unit,
                                         'CarpetArea'=> $carpet_area,
                                         'CarpetUnit'=> $carpet_area_unit,
                                         'BuildupArea'=> $bulid_up,
                                         'BuildupAreaUnit'=> $build_up_unit,
                                         'TotalLandArea'=> $total_area,
                                         'TotalLandAreaUnit'=> $total_area_unit,
                                         'TotalUncoveredLandArea'=> $total_uncovered_area,
                                         'TotalUncoveredLandAreaUnit'=>$total_uncovered_unit,
                                         'balcony'=>$balcony,
                                         'kitchen'=>$kitchen,
                                         'totalfloor'=>$total_floor,
                                         'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_house_details',$house);
                                }
            		        }
                		}
                	}
                }
                
                if($form_data['residential'] == "PentHouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'PentHouse',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $duplex_flat = array(
                                                 'post_id'=>$result,
                                                 'Room'=> $rooms,
                                                 'Bathroom'=> $bathrooms,
                                                 'FlatMinimumAreaRequired'=> $min_area,
                                                 'SuperBuildupAreaUnit'=> $min_area_unit,
                                                 'FlatMaximumAreaRequired'=> $max_area,
                                                 'BuildupAreaUnit'=> $max_area_unit,
                                                 'MinimumFloorHeight'=>$min_floor_hights,
                                                 'MaximumFloorHeight'=>$max_floor_hights,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupUnit'=>$supper_b_unit,
                                                 'BuildupArea'=>$bulid_up,
                                                 'BuildupUnit'=>$build_up_unit,
                                                 'CarpetArea'=>$carpet_area,
                                                 'CarpetAreaUnit'=>$carpet_area_unit,
                                                 'balcony'=>$balcony,
                                                 'kitchen'=>$kitchen,
                                                 'totalfloor'=>$total_floor,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                                }
            		        }
                		}
                	}
               }
               
                if($form_data['residential'] == "DuplexFlat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'DuplexFlat',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $duplex_flat = array(
                                                 'post_id'=>$result,
                                                 'Room'=> $rooms,
                                                 'Bathroom'=> $bathrooms,
                                                 'FlatMinimumAreaRequired'=> $min_area,
                                                 'SuperBuildupAreaUnit'=> $min_area_unit,
                                                 'FlatMaximumAreaRequired'=> $max_area,
                                                 'BuildupAreaUnit'=> $max_area_unit,
                                                 'MinimumFloorHeight'=>$min_floor_hights,
                                                 'MaximumFloorHeight'=>$max_floor_hights,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupUnit'=>$supper_b_unit,
                                                 'BuildupArea'=>$bulid_up,
                                                 'BuildupUnit'=>$build_up_unit,
                                                 'CarpetArea'=>$carpet_area,
                                                 'CarpetAreaUnit'=>$carpet_area_unit,
                                                 'balcony'=>$balcony,
                                                 'kitchen'=>$kitchen,
                                                 'totalfloor'=>$total_floor,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                                }
            		        }
                		}
                	}
               }
                
                if($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			
                    			$landfacing = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rodewide = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$rodewide_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$land_status = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$nature_of_land = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$property_tax = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$mutation = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$covered_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$covred_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Land',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $land = array(
                                                 'post_id'=>$result,
                                                 'LandMinimumAreaRequired'=> $min_area,
                                                 'LandSuperBuildupAreaUnit'=>$min_area_unit,
                                                 'LandMaximumAreaRequired'=>$max_area,
                                                 'MaximumAreaRequiredUnit'=>$max_area_unit,
                                                 'LandFacing'=> $landfacing,
                                                 'LandRoadWide'=>$rodewide,
                                                 'LandRoadWideUnit'=>$rodewide_unit,
                                                 'LandStatus'=>$land_status,
                                                 'NatureofLand'=>$nature_of_land,
                                                 'PropertyTax'=>$property_tax,
                                                 'Mutation'=>$mutation,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupAreaUnit'=>$supper_b_unit,
                                                 'CoveredArea'=>$covered_area,
                                                 'CoveredAreaUnit'=>$covred_area_unit,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_land_details',$land);
                                }
            		        }
                		}
                	}
               }
            }
            else if($form_data['buy_rent'] == "rent")
            {
                if($form_data['residential'] == "Flat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id' => $lead_partner_id,
                                                     'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Flat',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $duplex_flat = array(
                                                 'post_id'=>$result,
                                                 'Room'=> $rooms,
                                                 'Bathroom'=> $bathrooms,
                                                 'FlatMinimumAreaRequired'=> $min_area,
                                                 'SuperBuildupAreaUnit'=> $min_area_unit,
                                                 'FlatMaximumAreaRequired'=> $max_area,
                                                 'BuildupAreaUnit'=> $max_area_unit,
                                                 'MinimumFloorHeight'=>$min_floor_hights,
                                                 'MaximumFloorHeight'=>$max_floor_hights,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupUnit'=>$supper_b_unit,
                                                 'BuildupArea'=>$bulid_up,
                                                 'BuildupUnit'=>$build_up_unit,
                                                 'CarpetArea'=>$carpet_area,
                                                 'CarpetAreaUnit'=>$carpet_area_unit,
                                                 'balcony'=>$balcony,
                                                 'kitchen'=>$kitchen,
                                                 'totalfloor'=>$total_floor,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                                }
            		        }
                		}
                	}
                }
                
                if($form_data['residential'] == "HouseorBanglow")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$total_area = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$total_area_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$total_uncovered_unit = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=> $lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'HouseOrBanglow',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $house = array(
                                         'post_id'=>$result,
                                         'HouseRoom'=> $rooms,
                                         'HouseBathroom'=> $bathrooms,
                                         'SuperBuildupArea'=> $supper_buildup,
                                         'SuperBuildupAreaUnit'=> $supper_b_unit,
                                         'MinimumAreaRequired'=> $min_area,
                                         'StockMinimumAreaRequiredUnit'=>$min_area_unit,
                                         'HouseMaximumAreaRequired'=> $max_area,
                                         'HouseMaximumOpenAreaUnit'=> $max_area_unit,
                                         'CarpetArea'=> $carpet_area,
                                         'CarpetUnit'=> $carpet_area_unit,
                                         'BuildupArea'=> $bulid_up,
                                         'BuildupAreaUnit'=> $build_up_unit,
                                         'TotalLandArea'=> $total_area,
                                         'TotalLandAreaUnit'=> $total_area_unit,
                                         'TotalUncoveredLandArea'=> $total_uncovered_area,
                                         'TotalUncoveredLandAreaUnit'=>$total_uncovered_unit,
                                         'balcony'=>$balcony,
                                         'kitchen'=>$kitchen,
                                         'totalfloor'=>$total_floor,
                                         'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_house_details',$house);
                                }
            		        }
                		}
                	}
                }
                
                if($form_data['residential'] == "PentHouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'PentHouse',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $duplex_flat = array(
                                                 'post_id'=>$result,
                                                 'Room'=> $rooms,
                                                 'Bathroom'=> $bathrooms,
                                                 'FlatMinimumAreaRequired'=> $min_area,
                                                 'SuperBuildupAreaUnit'=> $min_area_unit,
                                                 'FlatMaximumAreaRequired'=> $max_area,
                                                 'BuildupAreaUnit'=> $max_area_unit,
                                                 'MinimumFloorHeight'=>$min_floor_hights,
                                                 'MaximumFloorHeight'=>$max_floor_hights,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupUnit'=>$supper_b_unit,
                                                 'BuildupArea'=>$bulid_up,
                                                 'BuildupUnit'=>$build_up_unit,
                                                 'CarpetArea'=>$carpet_area,
                                                 'CarpetAreaUnit'=>$carpet_area_unit,
                                                 'balcony'=>$balcony,
                                                 'kitchen'=>$kitchen,
                                                 'totalfloor'=>$total_floor,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                                }
            		        }
                		}
                	}
               }
               
                if($form_data['residential'] == "DuplexFlat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'DuplexFlat',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $duplex_flat = array(
                                                 'post_id'=>$result,
                                                 'Room'=> $rooms,
                                                 'Bathroom'=> $bathrooms,
                                                 'FlatMinimumAreaRequired'=> $min_area,
                                                 'SuperBuildupAreaUnit'=> $min_area_unit,
                                                 'FlatMaximumAreaRequired'=> $max_area,
                                                 'BuildupAreaUnit'=> $max_area_unit,
                                                 'MinimumFloorHeight'=>$min_floor_hights,
                                                 'MaximumFloorHeight'=>$max_floor_hights,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupUnit'=>$supper_b_unit,
                                                 'BuildupArea'=>$bulid_up,
                                                 'BuildupUnit'=>$build_up_unit,
                                                 'CarpetArea'=>$carpet_area,
                                                 'CarpetAreaUnit'=>$carpet_area_unit,
                                                 'balcony'=>$balcony,
                                                 'kitchen'=>$kitchen,
                                                 'totalfloor'=>$total_floor,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                                }
            		        }
                		}
                	}
               }
                
                if($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			
                    			$landfacing = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$rodewide = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$rodewide_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$land_status = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$nature_of_land = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$property_tax = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$mutation = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$covered_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$covred_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Land',
                                             'residential_commercial'=> 'Residential',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $land = array(
                                                 'post_id'=>$result,
                                                 'LandMinimumAreaRequired'=> $min_area,
                                                 'LandSuperBuildupAreaUnit'=>$min_area_unit,
                                                 'LandMaximumAreaRequired'=>$max_area,
                                                 'MaximumAreaRequiredUnit'=>$max_area_unit,
                                                 'LandFacing'=> $landfacing,
                                                 'LandRoadWide'=>$rodewide,
                                                 'LandRoadWideUnit'=>$rodewide_unit,
                                                 'LandStatus'=>$land_status,
                                                 'NatureofLand'=>$nature_of_land,
                                                 'PropertyTax'=>$property_tax,
                                                 'Mutation'=>$mutation,
                                                 'SuperBuildupArea'=>$supper_buildup,
                                                 'SuperBuildupAreaUnit'=>$supper_b_unit,
                                                 'CoveredArea'=>$covered_area,
                                                 'CoveredAreaUnit'=>$covred_area_unit,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_land_details',$land);
                                }
            		        }
                		}
                	}
               }
            }
        }
        else if($form_data['res_com'] == "Commercial")
        {
            if($form_data['buy_rent'] == "buy")
            {
                if($form_data['residential'] == "Office")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$no_of_work_station = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$Ac = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$nature_of_business = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Office',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $office = array(
                                        'post_id'=>$result,
                                        'NumberofCabin'=> $no_of_cabin,
                                        'NumberofWorkStation'=> $no_of_work_station,
                                        'MinimumAreaRequired'=> $min_area,
                                        'OfficeSuperBuildupAreaUnit'=>$min_area_unit,
                                        'MaximumAreaRequired'=>$max_area,
                                        'OfficeMaximumAreaRequiredUnit'=>$max_area_unit,
                                        'Pentry'=>$pentry,
                                        'PentryUsedFor'=>$pentry_user_for,
                                        'AC'=>$Ac,
                                        'OfficeMinimumFloorHeight'=>$min_floor_hights,
                                        'OfficeMaximumFloorHeight'=>$max_floor_hights,
                                        'SuperBuildupArea'=> $supper_buildup,
                                        'SuperBuildupAreaUnit'=> $supper_b_unit,
                                        'CarpetArea'=> $carpet_area,
                                        'CarpetAreaUnit'=>$carpet_area_unit,
                                        'BuildupArea'=>$bulid_up,
                                        'BuildupAreaUnit'=>$build_up_unit,
                                         'OfficeBathroom'=>$bathrooms,
                                         'OfficeNatureofBusiness'=>$nature_of_business,
                                         'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_office_details',$office);
                                }
            		        }
                		}
                	}
               }
               
                elseif($form_data['residential'] == "ShopOrShowroom")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$nature_of_business = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$frontage = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$frontage_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$covered_area = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$covered_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$open_area = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$op_area_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$roof = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$wideroad = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$wideroad_unit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$electric_power = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$ep_unit = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$for_bar = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$for_restro = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$heavr_vechical_upto = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(63,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(63,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                              'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'ShopOrShowroom',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $shop = array(
                                             'post_id'=>$result,
                                             'ShopNatureofBusiness'=> $nature_of_business,
                                             'Frontage'=> $frontage,
                                             'FrontageUnit'=> $frontage_unit,
                                             'ShopMinimumAreaRequired'=>$min_area,
                                             'MinimumAreaRequiredUnit'=>$min_area_unit,
                                             'ShopMaximumAreaRequired'=>$max_area,
                                             'ShopMaximumAreaRequiredUnit'=>$max_area_unit,
                                             'SuperBuildupArea'=>$supper_buildup,
                                             'SuperBuildupAreaUnit'=>$supper_b_unit,
                                             'CoveredArea'=>$covered_area,
                                             'CoveredAreaUnit'=>$covered_unit,
                                             'BuildupArea'=>$bulid_up,
                                             'BuildupAreaUnit'=>$build_up_unit,
                                             'OpenArea'=>$open_area,
                                             'OpenAreaUnit'=>$op_area_unit,
                                             'roof'=>$roof,
                                             'Floor'=>$floor,
                                             'Bathroom'=>$bathrooms,
                                             'Pentry'=>$pentry,
                                             'RoadWide'=>$wideroad,
                                             'RoadWideUnit'=>$wideroad_unit,
                                             'ElectricPower'=>$electric_power,
                                             'ElectricPowerUnit'=>$ep_unit,
                                             'AvailableForBar'=>$for_bar,
                                             'ForResturant'=>$for_restro,
                                             'HeavyVehicleParkingUpto'=>$heavr_vechical_upto,
                                             'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_shop_details',$shop);
                                }
            		        }
                		}
                	}
                }
                
                elseif($form_data['residential'] == "Warehouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
            
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			
                    			$supperbuildup = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$supperb_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$buildup = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$buildup_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$min_coiverd = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$min_c_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$max_c = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_c_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$min_open = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$min_o_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$max_open = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$max_o_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$min_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$max_floor = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$roof = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$roadwide = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$road_w_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$used_for = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$b_used_for = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=> $lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Warehouse',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $warehouse = array(
                                         'post_id'=>$result,
                                         'WarehouseRoof'=>$roof,
                                         'WarehouseRoadWide'=>$roadwide,
                                         'WarehouseRoadWideUnit'=>$road_w_unit,
                                         'WarehouseMinimumCoveredArea'=>$min_coiverd,
                                         'WarehouseMinimumOpenArea'=>$min_open,
                                         'WarehouseMinimumCoveredAreaUnit'=>$min_c_unit,
                                         'WarehouseMinimumOpenAreaUnit'=>$min_o_unit,
                                         'WarehouseMaximumOpenArea'=>$max_open,
                                         'WarehouseMaximumCoveredAreaUnit'=>$max_c_unit,
                                         'WarehouseMaximumOpenAreaUnit'=>$max_o_unit,
                                         'WarehouseMaximumCoveredArea'=>$max_c,
                                         'WarehouseHeavyVehicleParkingUpto'=>$vechicel_parking_upto,
                                         'MinimumFloor'=>$min_floor,
                                         'MaximumFloor'=>$max_floor,
                                         'SuperBuildupArea'=>$supperbuildup,
                                         'SuperBuildupAreaUnit'=>$supperb_unit,
                                         'BuildupArea'=>$buildup,
                                         'BuildupAreaUnit'=>$buildup_unit,
                                         'NumberofCabin'=>$no_of_cabin,
                                         'NumberofWorkStation'=>$no_of_workstations,
                                         'Pentry'=>$pentry,
                                         'PentryUsedFor'=>$used_for,
                                         'Bathroom'=>$bathrooms,
                                         'roof' => $roof,
                                         'heavy_p_upto' => $heavy_parking_uptp,
                                         'bathroom_used_for' => $b_used_for,
                                         'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_warehouse_details',$warehouse);
                                }
            		        }
                		}
                	}
               }
                
                elseif($form_data['residential'] == "Factory")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			
                    			$supperbuildup = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$supperb_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$buildup = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$buildup_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$min_coiverd = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$min_c_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$max_c = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_c_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$min_open = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$min_o_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$max_open = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$max_o_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$min_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$max_floor = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$roof = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$roadwide = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$road_w_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$used_for = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$b_used_for = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=> $lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Factory',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $factory = array(
                                                 'post_id'=>$result,
                                                 'MinimumOpenArea'=>$min_open,
                                                 'MinimumCoveredArea'=>$min_coiverd,
                                                 'MinimumOpenAreaUnit'=>$min_o_unit,
                                                 'MinimumCoveredAreaUnit'=>$min_c_unit,
                                                 'roof'=>$roof,
                                                 'ElectricPower'=>$min_floor,
                                                 'ElectricPowerUnit'=>$max_floor,
                                                 'NatureofBusiness'=>$vechicel_parking_upto,
                                                 'MaximumOpenArea'=>$max_open,
                                                 'MaximumCoveredArea'=>$max_c,
                                                 'MaximumOpenAreaUnit'=>$max_o_unit,
                                                 'MaximumCoveredAreaUnit'=>$max_c_unit,
                                                 
                                                 'SuperBuildupArea'=>$supperbuildup,
                                                 'SuperBuildupAreaUnit'=>$supperb_unit,
                                                 'BuildupArea'=>$buildup,
                                                 'BuildupAreaUnit'=>$buildup_unit,
                                                 
                                                 'RoadWide'=>$roadwide,
                                                 'RoadWideUnit'=>$road_w_unit,
                                                 'HeavyVehicleParkingUpto'=>$heavy_parking_uptp,
                                                 
                                                 'NumberofCabin'=>$no_of_cabin,
                                                 'NumberofWorkStation'=>$no_of_workstations,
                                                 'Pentry'=>$pentry,
                                                 'PentryUsedFor'=>$used_for,
                                                 'Bathroom'=>$bathrooms,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_factory_details',$factory);             
                                }
            		        }
                		}
                	}
               }
               
                elseif($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			
                    			$min_area = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$min_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$max_aera_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$land_facing = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$roadewat = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$roadway_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$supper_build = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$supper_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$coverd_area = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$covered_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$land_status = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$nature_of_land = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$property_tax = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$mutauation = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Land',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Sell',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                       
                                             'status'=>1,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $land = array(
                                                 'post_id'=>$result,
                                                 'LandMinimumAreaRequired'=> $min_area,
                                                 'LandSuperBuildupAreaUnit'=> $min_unit,
                                                 'LandMaximumAreaRequired'=>$max_area,
                                                 'MaximumAreaRequiredUnit'=>$max_aera_unit,
                                                 'SuperBuildupArea'=>$supper_build,
                                                 'SuperBuildupAreaUnit'=>$supper_unit,
                                                 'CoveredArea'=> $coverd_area,
                                                 'CoveredAreaUnit'=> $covered_unit,
                                                 'LandFacing'=> $land_facing,
                                                 'LandRoadWide'=> $roadewat,
                                                 'LandRoadWideUnit'=>$roadway_unit,
                                                 'LandStatus'=>$land_status,
                                                 'NatureofLand'=>$nature_of_land,
                                                 'PropertyTax'=>$property_tax,
                                                 'Mutation'=>$mutauation,
                                                 'created'=>date('Y-m-d H:i:s'));
                                     $res = $this->Common_model->insert_data('requirement_land_details',$land);
                                }
            		        }
                		}
                	}
                }
            }
            
            elseif($form_data['buy_rent'] == "rent")
            {
                if($form_data['residential'] == "Office")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$no_of_work_station = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$Ac = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$nature_of_business = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Office',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $office = array(
                                        'post_id'=>$result,
                                        'NumberofCabin'=> $no_of_cabin,
                                        'NumberofWorkStation'=> $no_of_work_station,
                                        'MinimumAreaRequired'=> $min_area,
                                        'OfficeSuperBuildupAreaUnit'=>$min_area_unit,
                                        'MaximumAreaRequired'=>$max_area,
                                        'OfficeMaximumAreaRequiredUnit'=>$max_area_unit,
                                        'Pentry'=>$pentry,
                                        'PentryUsedFor'=>$pentry_user_for,
                                        'AC'=>$Ac,
                                        'OfficeMinimumFloorHeight'=>$min_floor_hights,
                                        'OfficeMaximumFloorHeight'=>$max_floor_hights,
                                        'SuperBuildupArea'=> $supper_buildup,
                                        'SuperBuildupAreaUnit'=> $supper_b_unit,
                                        'CarpetArea'=> $carpet_area,
                                        'CarpetAreaUnit'=>$carpet_area_unit,
                                        'BuildupArea'=>$bulid_up,
                                        'BuildupAreaUnit'=>$build_up_unit,
                                         'OfficeBathroom'=>$bathrooms,
                                         'OfficeNatureofBusiness'=>$nature_of_business,
                                         'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_office_details',$office);
                                }
            		        }
                		}
                	}
               }
               
                elseif($form_data['residential'] == "ShopOrShowroom")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$nature_of_business = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$frontage = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$frontage_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$min_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$min_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$max_area_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$covered_area = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$covered_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$open_area = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$op_area_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$roof = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$floor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$wideroad = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$wideroad_unit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$electric_power = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$ep_unit = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$for_bar = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$for_restro = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$heavr_vechical_upto = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(63,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(63,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                              'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'ShopOrShowroom',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $shop = array(
                                             'post_id'=>$result,
                                             'ShopNatureofBusiness'=> $nature_of_business,
                                             'Frontage'=> $frontage,
                                             'FrontageUnit'=> $frontage_unit,
                                             'ShopMinimumAreaRequired'=>$min_area,
                                             'MinimumAreaRequiredUnit'=>$min_area_unit,
                                             'ShopMaximumAreaRequired'=>$max_area,
                                             'ShopMaximumAreaRequiredUnit'=>$max_area_unit,
                                             'SuperBuildupArea'=>$supper_buildup,
                                             'SuperBuildupAreaUnit'=>$supper_b_unit,
                                             'CoveredArea'=>$covered_area,
                                             'CoveredAreaUnit'=>$covered_unit,
                                             'BuildupArea'=>$bulid_up,
                                             'BuildupAreaUnit'=>$build_up_unit,
                                             'OpenArea'=>$open_area,
                                             'OpenAreaUnit'=>$op_area_unit,
                                             'roof'=>$roof,
                                             'Floor'=>$floor,
                                             'Bathroom'=>$bathrooms,
                                             'Pentry'=>$pentry,
                                             'RoadWide'=>$wideroad,
                                             'RoadWideUnit'=>$wideroad_unit,
                                             'ElectricPower'=>$electric_power,
                                             'ElectricPowerUnit'=>$ep_unit,
                                             'AvailableForBar'=>$for_bar,
                                             'ForResturant'=>$for_restro,
                                             'HeavyVehicleParkingUpto'=>$heavr_vechical_upto,
                                             'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_shop_details',$shop);
                                }
            		        }
                		}
                	}
                }
                
                elseif($form_data['residential'] == "Warehouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
            
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			
                    			$supperbuildup = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$supperb_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$buildup = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$buildup_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$min_coiverd = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$min_c_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$max_c = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_c_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$min_open = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$min_o_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$max_open = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$max_o_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$min_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$max_floor = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$roof = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$roadwide = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$road_w_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$used_for = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$b_used_for = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=> $lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Warehouse',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $warehouse = array(
                                         'post_id'=>$result,
                                         'WarehouseRoof'=>$roof,
                                         'WarehouseRoadWide'=>$roadwide,
                                         'WarehouseRoadWideUnit'=>$road_w_unit,
                                         'WarehouseMinimumCoveredArea'=>$min_coiverd,
                                         'WarehouseMinimumOpenArea'=>$min_open,
                                         'WarehouseMinimumCoveredAreaUnit'=>$min_c_unit,
                                         'WarehouseMinimumOpenAreaUnit'=>$min_o_unit,
                                         'WarehouseMaximumOpenArea'=>$max_open,
                                         'WarehouseMaximumCoveredAreaUnit'=>$max_c_unit,
                                         'WarehouseMaximumOpenAreaUnit'=>$max_o_unit,
                                         'WarehouseMaximumCoveredArea'=>$max_c,
                                         'WarehouseHeavyVehicleParkingUpto'=>$vechicel_parking_upto,
                                         'MinimumFloor'=>$min_floor,
                                         'MaximumFloor'=>$max_floor,
                                         'SuperBuildupArea'=>$supperbuildup,
                                         'SuperBuildupAreaUnit'=>$supperb_unit,
                                         'BuildupArea'=>$buildup,
                                         'BuildupAreaUnit'=>$buildup_unit,
                                         'NumberofCabin'=>$no_of_cabin,
                                         'NumberofWorkStation'=>$no_of_workstations,
                                         'Pentry'=>$pentry,
                                         'PentryUsedFor'=>$used_for,
                                         'Bathroom'=>$bathrooms,
                                         'roof' => $roof,
                                         'heavy_p_upto' => $heavy_parking_uptp,
                                         'bathroom_used_for' => $b_used_for,
                                         'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_warehouse_details',$warehouse);
                                }
            		        }
                		}
                	}
               }
                
                elseif($form_data['residential'] == "Factory")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$furnished_status = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			
                    			$supperbuildup = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$supperb_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$buildup = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$buildup_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$min_coiverd = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$min_c_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$max_c = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$max_c_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$min_open = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$min_o_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$max_open = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$max_o_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$min_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$max_floor = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$roof = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$roadwide = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$road_w_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$used_for = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$b_used_for = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$o_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$c_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$b_barking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$power_bkups = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$services_lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$banquite_hall = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$gym = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$intercom = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$swimming_pool = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$cloub_house = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$servent_room = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$lift = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$community_hall = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$indoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$outdoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$gas = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$park = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
            
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=> $lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Factory',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                             'OpenParking'=>$o_parking,
                                             'CoveredParking'=>$c_parking,
                                             'Basement'=>$b_barking,
                                             'LiftParking'=>$lift_parking,
                                             'TwoWheeler'=>$two_wiheerl,
                                             'status'=>1,
                                             'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                              'GYM'=>(!empty($gym)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                              'Lift'=>(!empty($lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                              'Park'=>(!empty($park)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $factory = array(
                                                 'post_id'=>$result,
                                                 'MinimumOpenArea'=>$min_open,
                                                 'MinimumCoveredArea'=>$min_coiverd,
                                                 'MinimumOpenAreaUnit'=>$min_o_unit,
                                                 'MinimumCoveredAreaUnit'=>$min_c_unit,
                                                 'roof'=>$roof,
                                                 'ElectricPower'=>$min_floor,
                                                 'ElectricPowerUnit'=>$max_floor,
                                                 'NatureofBusiness'=>$vechicel_parking_upto,
                                                 'MaximumOpenArea'=>$max_open,
                                                 'MaximumCoveredArea'=>$max_c,
                                                 'MaximumOpenAreaUnit'=>$max_o_unit,
                                                 'MaximumCoveredAreaUnit'=>$max_c_unit,
                                                 
                                                 'SuperBuildupArea'=>$supperbuildup,
                                                 'SuperBuildupAreaUnit'=>$supperb_unit,
                                                 'BuildupArea'=>$buildup,
                                                 'BuildupAreaUnit'=>$buildup_unit,
                                                 
                                                 'RoadWide'=>$roadwide,
                                                 'RoadWideUnit'=>$road_w_unit,
                                                 'HeavyVehicleParkingUpto'=>$heavy_parking_uptp,
                                                 
                                                 'NumberofCabin'=>$no_of_cabin,
                                                 'NumberofWorkStation'=>$no_of_workstations,
                                                 'Pentry'=>$pentry,
                                                 'PentryUsedFor'=>$used_for,
                                                 'Bathroom'=>$bathrooms,
                                                 'created'=>date('Y-m-d H:i:s'));
                                    $res = $this->Common_model->insert_data('requirement_factory_details',$factory);             
                                }
            		        }
                		}
                	}
               }
               
                elseif($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(11,$cl)->getValue())) : '';
                    			$min_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$max_price = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			
                    			$min_area = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$min_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$max_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$max_aera_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
                    			$land_facing = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$roadewat = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$roadway_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$supper_build = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$supper_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$coverd_area = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$covered_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$land_status = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$nature_of_land = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$property_tax = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$mutauation = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = $this->RandomString().$zeros;
                                $lead_id = 'REQ'.$zeros.($maxid+1);
            
                                $insert_data = array('user_id'=>$lead_partner_id,
                                             'user_type'=> 'lead_partner',
                                             'lead_id'=>$lead_id,
                                             
                                             'residential'=> 'Land',
                                             'residential_commercial'=> 'Commercial',
                                             'rent_sell'=> 'Rent',
                                             
                                             'name'=> $name,
                                             'mobile'=> $mobile,
                                             'mobile2'=> $mobile1,
                                             'phone'=> $phone,
                                             'email'=> $email,
                                             'state'=> $state,
                                             'city'=> $city,
                                             'location'=>!empty($location) ? $location : '',
                                             'MinimumRent'=> $min_price,
                                             'MaximumRent'=> $max_price,
                                             'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                             'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                             'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                             'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                       
                                             'status'=>1,
                                             'created'=>date('Y-m-d H:i:s'));
                                $result = $this->Common_model->insert_data('post_requirement',$insert_data);
                    			
                                if($result)
                                {
                                    $land = array(
                                                 'post_id'=>$result,
                                                 'LandMinimumAreaRequired'=> $min_area,
                                                 'LandSuperBuildupAreaUnit'=> $min_unit,
                                                 'LandMaximumAreaRequired'=>$max_area,
                                                 'MaximumAreaRequiredUnit'=>$max_aera_unit,
                                                 'SuperBuildupArea'=>$supper_build,
                                                 'SuperBuildupAreaUnit'=>$supper_unit,
                                                 'CoveredArea'=> $coverd_area,
                                                 'CoveredAreaUnit'=> $covered_unit,
                                                 'LandFacing'=> $land_facing,
                                                 'LandRoadWide'=> $roadewat,
                                                 'LandRoadWideUnit'=>$roadway_unit,
                                                 'LandStatus'=>$land_status,
                                                 'NatureofLand'=>$nature_of_land,
                                                 'PropertyTax'=>$property_tax,
                                                 'Mutation'=>$mutauation,
                                                 'created'=>date('Y-m-d H:i:s'));
                                     $res = $this->Common_model->insert_data('requirement_land_details',$land);
                                }
            		        }
                		}
                	}
                }
            }
        }
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyers_lead');
    }
    
    function sellers_leads()
    {
        $form_data = $this->input->post(array('res_com', 'buy_rent', 'residential'));
        if($form_data['res_com'] == "Residential")
        {
            if($form_data['buy_rent'] == "sell")
            {
                if($form_data['residential'] == "Flat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? date('Y-m-d', 
                    			PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Flat',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                $data = array(
                                    'post_id'=> $post_id,
                                    'flat_Room'=> $flat_rooms,
                                    'flat_Balcony'=> $balcony,
                                    'flat_SuperBuildupArea'=> $subper_built_up,
                                    'flat_CarpetArea'=> $carpet_area,
                                    'flat_SuperBuildupAreaUnit'=> $supper_b_unit,
                                    'flat_Carpet_Unit'=> $carpet_area_unit,
                                    'flat_TotalFloor'=> $total_floor,
                                    'flat_Bathroom'=> $bathrooms,
                                    'flat_Kitchen'=> $kitchen,
                                    'flat_BuildupArea'=> $bulid_up,
                                    'flat_BuildupArea_Unit'=> $build_up_unit,
                                    'flat_Floor'=> $flat_floor,
                                    'created'=>date('Y-m-d'),
                                );
                                $res = $this->Common_model->insert_data('flat_details', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('residential_amenities', $data);
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "HouseorBanglow")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? date('Y-m-d', 
                    			PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			
                    			$total_land_area = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$total_land_area_unit = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$total_uncovered_area_unit = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$covered_area = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$covered_area_unit = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
                   
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'HouseorBanglow',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                $data = array('post_id'=>$post_id,
                                              'house_Room'=> $flat_rooms,
                                              'house_Bathroom'=> $bathrooms,
                                              'house_Balcony'=> $balcony,
                                              'house_Kitchen'=> $kitchen,
                                              'house_TotalFloor'=> $total_floor,
                                              'house_SuperBuildupArea'=> $subper_built_up,
                                              'house_SuperBuildupArea_Unit'=> $supper_b_unit,
                                              'house_BuildupArea'=> $bulid_up,
                                              'house_BuildupAreaUnit'=> $build_up_unit,
                                                'house_CarpetArea'=> $carpet_area,
                                               'house_Carpet_Unit'=> $carpet_area_unit,
                                               'house_TotalLandArea'=> $total_land_area,
                                               'house_TotalLandArea_Unit'=> $total_land_area_unit,
                                               'house_TotalUncoveredLandArea'=> $total_uncovered_area,
                                              'house_TotalUncoveredLandArea_Unit'=>$total_uncovered_area_unit,
                                              'house_TotalCoveredLandArea'=> $covered_area,
                                              'house_TotalCoveredLandArea_unit'=> $covered_area_unit,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('house_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "PentHouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$open_terrace = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$open_terrace_unit = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'PentHouse',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                          'pent_room'=> $flat_rooms,
                                          'pent_bathroom'=> $bathrooms,
                                          'pent_balcony'=> $balcony,
                                          'pent_kitchen'=> $kitchen,
                                          'pent_floor'=> $flat_floor,
                                          'total_floor'=> $total_floor,
                                          'pent_super_buildup_area'=> $subper_built_up,
                                          'pent_super_buildup_area_Unit'=> $supper_b_unit,
                                          'pent_buildup_area'=> $bulid_up,
                                          'pent_buildup_area_Unit'=> $build_up_unit,
                                          'pent_carpet_area'=> $carpet_area,
                                          'pent_carpet_unit'=> $carpet_area_unit,
                                          'open_terrace'=> $open_terrace,
                                          'pent_open_terrace_unit'=> $open_terrace_unit,
                                          'created'=>date('Y-m-d'),
                                         );
                            $res = $this->Common_model->insert_data('pent_house_details', $data);
                            
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                            $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "DuplexFlat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? date('Y-m-d', 
                    			PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(522,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$lower_floor_no = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$upperfloorno = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'DuplexFlat',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'room'=> $flat_rooms,
                                              'bathroom'=> $bathrooms,
                                              'balcony'=> $balcony,
                                              'kitchen'=> $kitchen,
                                              'lower_floor_no'=> $lower_floor_no,
                                              'upperfloorno'=> $upperfloorno,
                                              'totalfloor'=> $total_floor,
                                              'super_buildup_area'=> $subper_built_up,
                                              'super_buildup_area_unit'=> $supper_b_unit,
                                              'buildup_area'=> $bulid_up,
                                              'buildup_area_Unit'=> $build_up_unit,
                                              'carpet_area'=> $carpet_area,
                                              'carpet_unit'=> $carpet_area_unit,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('duplex_flat_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                            $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? date('Y-m-d', 
                    			PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$LandArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$LandStatus = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$NatureofLand = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$PropertyTax = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$Mutation = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$LandFacing = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Land',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                
                                $data = array('post_id'=>$post_id,
                                               'LandArea'=> $LandArea,
                                              'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                              'landCoveredArea'=> $landCoveredArea,
                                              'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                              'LandRoadWide'=> $LandRoadWide,
                                              'LandRoadWideUnit'=> $LandRoadWideUnit,
                                              'LandStatus'=> $LandStatus,
                                              'IstheExistingOwner'=> $IstheExistingOwner,
                                              'NatureofLand'=> $NatureofLand,
                                              'NoOfOwner'=> $NoOfOwner,
                                              'PropertyTax'=> $PropertyTax,
                                              'Mutation'=> $Mutation,
                                              'LandFacing'=> $LandFacing,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('land_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
            
                   			}
                		}
                	}
                }
            }
            else if($form_data['buy_rent'] == "rent")
            {
                if($form_data['residential'] == "Flat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                // 	pre($objPHPExcel);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            // 			pre($highestRow);
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array('security_deposite'=> $net_amount,
                                              'rentPerMonth'=> $booking_ant,
                                              'post_id'=>$post_id,
                                              'rent_sell'=> 'Rent',
                                              'res_com'=> 'Residential',
                                              'FurnishedStatus'=> $furnish_status,
                                              'residential'=> 'Flat',
                                              'created'=>date('Y-m-d'),
                                            );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                $data = array(
                                    'post_id'=> $post_id,
                                    'flat_Room'=> $flat_rooms,
                                    'flat_Balcony'=> $balcony,
                                    'flat_SuperBuildupArea'=> $subper_built_up,
                                    'flat_CarpetArea'=> $carpet_area,
                                    'flat_SuperBuildupAreaUnit'=> $supper_b_unit,
                                    'flat_Carpet_Unit'=> $carpet_area_unit,
                                    'flat_TotalFloor'=> $total_floor,
                                    'flat_Bathroom'=> $bathrooms,
                                    'flat_Kitchen'=> $kitchen,
                                    'flat_BuildupArea'=> $bulid_up,
                                    'flat_BuildupArea_Unit'=> $build_up_unit,
                                    'flat_Floor'=> $flat_floor,
                                    'created'=>date('Y-m-d'),
                                );
                                $res = $this->Common_model->insert_data('flat_details', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                            $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "HouseorBanglow")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$total_land_area = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$total_land_area_unit = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                    			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
                    			$total_uncovered_area_unit = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
                    			$covered_area = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
                    			$covered_area_unit = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';
                   
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                    
                                    'security_deposite'=> $net_amount,
                                              'rentPerMonth'=> $booking_ant,
                                              'post_id'=>$post_id,
                                              'rent_sell'=> 'Rent',
                                              'res_com'=> 'Residential',
                                              'FurnishedStatus'=> $furnish_status,
                                              'residential'=> 'HouseorBanglow',
                                              'created'=>date('Y-m-d'),
                                    
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                $data = array('post_id'=>$post_id,
                                              'house_Room'=> $flat_rooms,
                                              'house_Bathroom'=> $bathrooms,
                                              'house_Balcony'=> $balcony,
                                              'house_Kitchen'=> $kitchen,
                                              'house_TotalFloor'=> $total_floor,
                                              'house_SuperBuildupArea'=> $subper_built_up,
                                              'house_SuperBuildupArea_Unit'=> $supper_b_unit,
                                              'house_BuildupArea'=> $bulid_up,
                                              'house_BuildupAreaUnit'=> $build_up_unit,
                                                'house_CarpetArea'=> $carpet_area,
                                               'house_Carpet_Unit'=> $carpet_area_unit,
                                               'house_TotalLandArea'=> $total_land_area,
                                               'house_TotalLandArea_Unit'=> $total_land_area_unit,
                                               'house_TotalUncoveredLandArea'=> $total_uncovered_area,
                                              'house_TotalUncoveredLandArea_Unit'=>$total_uncovered_area_unit,
                                              'house_TotalCoveredLandArea'=> $covered_area,
                                              'house_TotalCoveredLandArea_unit'=> $covered_area_unit,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('house_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                            $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "PentHouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? date('Y-m-d', 
                    			PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$open_terrace = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$open_terrace_unit = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                   
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                    
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Rent',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'PentHouse',
                                        'security_deposite'=> $net_amount,
                                              'rentPerMonth'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                          'pent_room'=> $flat_rooms,
                                          'pent_bathroom'=> $bathrooms,
                                          'pent_balcony'=> $balcony,
                                          'pent_kitchen'=> $kitchen,
                                          'pent_floor'=> $flat_floor,
                                          'total_floor'=> $total_floor,
                                          'pent_super_buildup_area'=> $subper_built_up,
                                          'pent_super_buildup_area_Unit'=> $supper_b_unit,
                                          'pent_buildup_area'=> $bulid_up,
                                          'pent_buildup_area_Unit'=> $build_up_unit,
                                          'pent_carpet_area'=> $carpet_area,
                                          'pent_carpet_unit'=> $carpet_area_unit,
                                          'open_terrace'=> $open_terrace,
                                          'pent_open_terrace_unit'=> $open_terrace_unit,
                                          'created'=>date('Y-m-d'),
                                         );
                            $res = $this->Common_model->insert_data('pent_house_details', $data);
                            
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                            $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "DuplexFlat")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$flat_rooms = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$flat_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$kitchen = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$powerbackups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$ServiveLift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$BanquetHall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$GYM = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$VisitorParking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$Intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$CCTV = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$CloubHouse = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$Lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$WIFI = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$CommunityHall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$IndoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$Park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$Security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$lower_floor_no = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$upperfloorno = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Rent',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'DuplexFlat',
            
                                        'security_deposite'=> $net_amount,
                                        'rentPerMonth'=> $booking_ant,
                                        
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'room'=> $flat_rooms,
                                              'bathroom'=> $bathrooms,
                                              'balcony'=> $balcony,
                                              'kitchen'=> $kitchen,
                                              'lower_floor_no'=> $lower_floor_no,
                                              'upperfloorno'=> $upperfloorno,
                                              'totalfloor'=> $total_floor,
                                              'super_buildup_area'=> $subper_built_up,
                                              'super_buildup_area_unit'=> $supper_b_unit,
                                              'buildup_area'=> $bulid_up,
                                              'buildup_area_Unit'=> $build_up_unit,
                                              'carpet_area'=> $carpet_area,
                                              'carpet_unit'=> $carpet_area_unit,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('duplex_flat_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                              'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                              'GYM'=>(!empty($GYM)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                              'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                              'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                              'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                              'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                              'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                              'Lift'=>(!empty($Lift)) ? 1 : 0,
                                              'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                              'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                              'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                              'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                              'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                              'Park'=>(!empty($Park)) ? 1 : 0,
                                              'Security'=>(!empty($Security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                            $res = $this->Common_model->insert_data('residential_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			
                    			$LandArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$LandStatus = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$NatureofLand = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$PropertyTax = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$Mutation = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$LandFacing = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Rent',
                                        'res_com'=> 'Residential',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Land',
                                        
                                        'security_deposite'=> $net_amount,
                                        'rentPerMonth'=> $booking_ant,
                                        
                                        'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                
                                $data = array('post_id'=>$post_id,
                                               'LandArea'=> $LandArea,
                                              'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                              'landCoveredArea'=> $landCoveredArea,
                                              'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                              'LandRoadWide'=> $LandRoadWide,
                                              'LandRoadWideUnit'=> $LandRoadWideUnit,
                                              'LandStatus'=> $LandStatus,
                                              'IstheExistingOwner'=> $IstheExistingOwner,
                                              'NatureofLand'=> $NatureofLand,
                                              'NoOfOwner'=> $NoOfOwner,
                                              'PropertyTax'=> $PropertyTax,
                                              'Mutation'=> $Mutation,
                                              'LandFacing'=> $LandFacing,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('land_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
            
                   			}
                		}
                	}
                }
            }
        }
        
        elseif($form_data['res_com'] == "Commercial")
        {
            if($form_data['buy_rent'] == "sell")
            {
                if($form_data['residential'] == "Office")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$no_cabins = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$no_of_work_stations = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$ac = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$Bathrooms = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Office',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'officeNumberofCabin'=> $no_cabins,
                                              'officeNumberofWorkStation'=> $no_of_work_stations,
                                              'officeSuperBuildupArea'=> $subper_built_up,
                                              'officeSuperBuildupAreaUnit'=> $supper_b_unit,
                                              'officeBuildupArea'=> $bulid_up,
                                              'officeBuildupAreaUnit'=> $build_up_unit,
                                              'officeCarpetArea'=> $carpet_area,
                                              'officeCarpetUnit'=>$carpet_area_unit,
                                              'officeAC'=>$ac,
                                              'Flooroffice'=> $floor,
                                              'officeTotalFloor'=> $total_floor,
                                              'Pentryoffice'=> $pentry,
                                              'PentryofficeUsedFor'=> $pentry_user_for,
                                              'officeBathroom'=> $Bathrooms,
                                              'BathroomofficeUsedFor'=>$bathrooms_used_for,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('office_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "ShopOrShowroom")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ?
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$shoproof = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$shopFrontage = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$shopFrontageUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$shopSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$shopSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$shopBuildupArea = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$shopBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$shopCoveredArea = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$shopCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$shopOpenArea = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$shopOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$shopFloor = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$shopTotalFloor = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$shopBathroom = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$shopBathroomUnit = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$shopPentry = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$shopRoadWide = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$shopRoadWideUnit = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$shopElectricPower = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$shopElectricPowerUnit = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$shopAvailableForBar = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$shopForResturant = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$shopHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'ShopOrShowroom',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'shoproof'=>$shoproof,
                                              'shopFrontage'=>$shopFrontage,
                                              'shopFrontageUnit'=>$shopFrontageUnit,
                                              'shopSuperBuildupArea'=>$shopSuperBuildupArea,
                                              'shopSuperBuildupAreaUnit'=>$shopSuperBuildupAreaUnit,
                                              'shopBuildupArea'=>$shopBuildupArea,
                                              'shopBuildupAreaUnit'=>$shopBuildupAreaUnit,
                                              'shopCoveredArea'=>$shopCoveredArea,
                                              'shopCoveredAreaUnit'=>$shopCoveredAreaUnit,
                                              'shopOpenArea'=>$shopOpenArea,
                                              'shopOpenAreaUnit'=>$shopOpenAreaUnit,
                                              'shopFloor'=>$shopFloor,
                                              'shopTotalFloor'=>$shopTotalFloor,
                                              'shopBathroom'=>$shopBathroom,
                                              'shopBathroomUnit'=>$shopBathroomUnit,
                                              'shopPentry'=>$shopPentry,
                                              'shopPentryUsedFor'=>$shopPentryUsedFor,
                                              'shopRoadWide'=>$shopRoadWide,
                                              'shopRoadWideUnit'=>$shopRoadWideUnit,
                                              'shopElectricPower'=>$shopElectricPower,
                                              'shopElectricPowerUnit'=>$shopElectricPowerUnit,
                                              'shopAvailableForBar'=>$shopAvailableForBar,
                                              'shopForResturant'=>$shopForResturant,
                                              'shopHeavyVehicleParkingUpto'=>$shopHeavyVehicleParkingUpto,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('shop_details', $data);
                                
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Warehouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$warehouseCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$warehouseroof = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                                $shopPentry = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Warehouse',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'warehouseNumberofCabin'=>$warehouseNumberofCabin,
                                              'warehouseSuperBuildupArea'=>$warehouseSuperBuildupArea,
                                              'warehouseSuperBuildupAreaUnit'=>$warehouseSuperBuildupAreaUnit,
                                              'warehouseCoveredAreaUnit'=>$warehouseCoveredAreaUnit,
                                              'warehouseFloor'=>$warehouseFloor,
                                              'warehouseroof'=>$warehouseroof,
                                              'warehouseRoadWide'=>$warehouseRoadWide,
                                              'warehouseRoadWideUnit'=>$warehouseRoadWideUnit,
                                              'warehouseHeavyVehicleParkingUpto'=>$warehouseHeavyVehicleParkingUpto,
                                              'warehouseNumberofWorkStation'=>$warehouseNumberofWorkStation,
                                              'warehouseBuildupArea'=>$warehouseBuildupArea,
                                              'warehouseOpenArea'=>$warehouseOpenArea,
                                              
                                              'warehouseBuildupAreaUnit'=>$warehouseBuildupAreaUnit,
                                              'warehouseOpenAreaUnit'=>$warehouseOpenAreaUnit,
                                              'warehouseTotalFloor'=>$warehouseTotalFloor,
                                              'warehousePentry'=> $shopPentry,
                                              'warehouseBathroom'=>$warehouseBathroom,
                                              'warehousePentryUsedFor'=>$shopPentryUsedFor,
                                              'warehouseBathroomUsedFor'=>$warehouseBathroomUsedFor,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('warehouse_details', $data);
                                
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Factory")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$factory_carpet_area = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$factory_carpet_area_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$ManufacturingType = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                                $shopPentry = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$ElectricPower = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Factory',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
            
                                
                                $data = array('post_id'=>$post_id,'factory_numberofcabin'=>$warehouseNumberofCabin,
                                              'factory_super_buildup_area'=>$warehouseSuperBuildupArea,
                                              'factory_carpet_area'=>$factory_carpet_area,
                                              'factory_super_buildup_area_unit'=>$warehouseSuperBuildupAreaUnit,
                                              'factory_carpet_unit'=>$factory_carpet_unit,
                                              'factory_floor'=> $warehouseFloor,
                                              'factory_pentry'=> $shopPentry,
                                              'factory_roadWide'=> $warehouseRoadWide,
                                              'factory_pentry_usedFor'=> $shopPentryUsedFor,
                                              'factory_roadWide_unit'=> $warehouseRoadWideUnit,
                                              'factory_ManufacturingType'=> $ManufacturingType,
                                              'factory_NumberofWorkStation'=> $warehouseNumberofWorkStation,
                                              'factory_BuildupArea'=> $warehouseBuildupArea,
                                              'factory_OpenArea'=> $warehouseOpenArea,
                                              'factory_BuildupAreaUnit'=> $warehouseBuildupAreaUnit,
                                              'factory_OpenAreaUnit'=> $warehouseOpenAreaUnit,
                                              'factory_TotalFloor'=> $warehouseTotalFloor,
                                              'factory_Bathroom'=> $warehouseBathroom,
                                              'factory_ElectricPower'=> $ElectricPower,
                                              'factory_Bathroom_UsedFor'=> $warehouseBathroomUsedFor,
                                              'factory_HeavyVehicleParkingUpto'=> $warehouseHeavyVehicleParkingUpto,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('factory_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$LandArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$LandStatus = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$NatureofLand = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$PropertyTax = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$Mutation = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$LandFacing = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Sell',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Land',
                                        'net_amount'=> $net_amount,
                                        'amount'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                
                                $data = array('post_id'=>$post_id,
                                               'LandArea'=> $LandArea,
                                              'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                              'landCoveredArea'=> $landCoveredArea,
                                              'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                              'LandRoadWide'=> $LandRoadWide,
                                              'LandRoadWideUnit'=> $LandRoadWideUnit,
                                              'LandStatus'=> $LandStatus,
                                              'IstheExistingOwner'=> $IstheExistingOwner,
                                              'NatureofLand'=> $NatureofLand,
                                              'NoOfOwner'=> $NoOfOwner,
                                              'PropertyTax'=> $PropertyTax,
                                              'Mutation'=> $Mutation,
                                              'LandFacing'=> $LandFacing,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('land_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
            
                   			}
                		}
                	}
                }
            }
            else if($form_data['buy_rent'] == "rent")
            {
                if($form_data['residential'] == "Office")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$no_cabins = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$no_of_work_stations = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$subper_built_up = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$bulid_up = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$build_up_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$carpet_area = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$ac = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$total_floor = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$pentry = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$Bathrooms = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                
                                $data = array(
                                    'post_id'=>$post_id,
                                    'rent_sell'=> 'Rent',
                                    'res_com'=> 'Commercial',
                                    'FurnishedStatus'=> $furnish_status,
                                    'residential'=> 'Office',
                                    'security_deposite'=> $net_amount,
                                    'rentPerMonth'=> $booking_ant,
                                    'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'officeNumberofCabin'=> $no_cabins,
                                              'officeNumberofWorkStation'=> $no_of_work_stations,
                                              'officeSuperBuildupArea'=> $subper_built_up,
                                              'officeSuperBuildupAreaUnit'=> $supper_b_unit,
                                              'officeBuildupArea'=> $bulid_up,
                                              'officeBuildupAreaUnit'=> $build_up_unit,
                                              'officeCarpetArea'=> $carpet_area,
                                              'officeCarpetUnit'=>$carpet_area_unit,
                                              'officeAC'=>$ac,
                                              'Flooroffice'=> $floor,
                                              'officeTotalFloor'=> $total_floor,
                                              'Pentryoffice'=> $pentry,
                                              'PentryofficeUsedFor'=> $pentry_user_for,
                                              'officeBathroom'=> $Bathrooms,
                                              'BathroomofficeUsedFor'=>$bathrooms_used_for,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('office_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "ShopOrShowroom")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ?
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$shoproof = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$shopFrontage = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$shopFrontageUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$shopSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$shopSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$shopBuildupArea = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$shopBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$shopCoveredArea = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$shopCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$shopOpenArea = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$shopOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$shopFloor = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$shopTotalFloor = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$shopBathroom = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$shopBathroomUnit = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$shopPentry = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$shopRoadWide = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$shopRoadWideUnit = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$shopElectricPower = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$shopElectricPowerUnit = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			$shopAvailableForBar = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
                    			$shopForResturant = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
                    			$shopHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Rent',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'ShopOrShowroom',
                                        'security_deposite'=> $net_amount,
                                        'rentPerMonth'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'shoproof'=>$shoproof,
                                              'shopFrontage'=>$shopFrontage,
                                              'shopFrontageUnit'=>$shopFrontageUnit,
                                              'shopSuperBuildupArea'=>$shopSuperBuildupArea,
                                              'shopSuperBuildupAreaUnit'=>$shopSuperBuildupAreaUnit,
                                              'shopBuildupArea'=>$shopBuildupArea,
                                              'shopBuildupAreaUnit'=>$shopBuildupAreaUnit,
                                              'shopCoveredArea'=>$shopCoveredArea,
                                              'shopCoveredAreaUnit'=>$shopCoveredAreaUnit,
                                              'shopOpenArea'=>$shopOpenArea,
                                              'shopOpenAreaUnit'=>$shopOpenAreaUnit,
                                              'shopFloor'=>$shopFloor,
                                              'shopTotalFloor'=>$shopTotalFloor,
                                              'shopBathroom'=>$shopBathroom,
                                              'shopBathroomUnit'=>$shopBathroomUnit,
                                              'shopPentry'=>$shopPentry,
                                              'shopPentryUsedFor'=>$shopPentryUsedFor,
                                              'shopRoadWide'=>$shopRoadWide,
                                              'shopRoadWideUnit'=>$shopRoadWideUnit,
                                              'shopElectricPower'=>$shopElectricPower,
                                              'shopElectricPowerUnit'=>$shopElectricPowerUnit,
                                              'shopAvailableForBar'=>$shopAvailableForBar,
                                              'shopForResturant'=>$shopForResturant,
                                              'shopHeavyVehicleParkingUpto'=>$shopHeavyVehicleParkingUpto,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('shop_details', $data);
                                
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Warehouse")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$warehouseCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$warehouseroof = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                                $shopPentry = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                    			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                               $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Rent',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Warehouse',
                                        'security_deposite'=> $net_amount,
                                        'rentPerMonth'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                $data = array('post_id'=>$post_id,
                                              'warehouseNumberofCabin'=>$warehouseNumberofCabin,
                                              'warehouseSuperBuildupArea'=>$warehouseSuperBuildupArea,
                                              'warehouseSuperBuildupAreaUnit'=>$warehouseSuperBuildupAreaUnit,
                                              'warehouseCoveredAreaUnit'=>$warehouseCoveredAreaUnit,
                                              'warehouseFloor'=>$warehouseFloor,
                                              'warehouseroof'=>$warehouseroof,
                                              'warehouseRoadWide'=>$warehouseRoadWide,
                                              'warehouseRoadWideUnit'=>$warehouseRoadWideUnit,
                                              'warehouseHeavyVehicleParkingUpto'=>$warehouseHeavyVehicleParkingUpto,
                                              'warehouseNumberofWorkStation'=>$warehouseNumberofWorkStation,
                                              'warehouseBuildupArea'=>$warehouseBuildupArea,
                                              'warehouseOpenArea'=>$warehouseOpenArea,
                                              
                                              'warehouseBuildupAreaUnit'=>$warehouseBuildupAreaUnit,
                                              'warehouseOpenAreaUnit'=>$warehouseOpenAreaUnit,
                                              'warehouseTotalFloor'=>$warehouseTotalFloor,
                                              'warehousePentry'=> $shopPentry,
                                              'warehouseBathroom'=>$warehouseBathroom,
                                              'warehousePentryUsedFor'=>$shopPentryUsedFor,
                                              'warehouseBathroomUsedFor'=>$warehouseBathroomUsedFor,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('warehouse_details', $data);
                                
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
            
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Factory")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$factory_carpet_area = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$factory_carpet_area_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$ManufacturingType = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                    			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
                                $shopPentry = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
                    			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
                    			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
                    			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
                    			$security = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
                    			$powerbk = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
                    			$lilft = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
                    			$service_lift = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
                    			$wifi = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
                    			$intercome = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
                    			$v_parking = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
                    			$cctv = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
                    			$ElectricPower = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
                    			
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Factory',
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                                $res = $this->Common_model->insert_data('property_type', $data);
            
                                
                                $data = array('post_id'=>$post_id,'factory_numberofcabin'=>$warehouseNumberofCabin,
                                              'factory_super_buildup_area'=>$warehouseSuperBuildupArea,
                                              'factory_carpet_area'=>$factory_carpet_area,
                                              'factory_super_buildup_area_unit'=>$warehouseSuperBuildupAreaUnit,
                                              'factory_carpet_unit'=>$factory_carpet_unit,
                                              'factory_floor'=> $warehouseFloor,
                                              'factory_pentry'=> $shopPentry,
                                              'factory_roadWide'=> $warehouseRoadWide,
                                              'factory_pentry_usedFor'=> $shopPentryUsedFor,
                                              'factory_roadWide_unit'=> $warehouseRoadWideUnit,
                                              'factory_ManufacturingType'=> $ManufacturingType,
                                              'factory_NumberofWorkStation'=> $warehouseNumberofWorkStation,
                                              'factory_BuildupArea'=> $warehouseBuildupArea,
                                              'factory_OpenArea'=> $warehouseOpenArea,
                                              'factory_BuildupAreaUnit'=> $warehouseBuildupAreaUnit,
                                              'factory_OpenAreaUnit'=> $warehouseOpenAreaUnit,
                                              'factory_TotalFloor'=> $warehouseTotalFloor,
                                              'factory_Bathroom'=> $warehouseBathroom,
                                              'factory_ElectricPower'=> $ElectricPower,
                                              'factory_Bathroom_UsedFor'=> $warehouseBathroomUsedFor,
                                              'factory_HeavyVehicleParkingUpto'=> $warehouseHeavyVehicleParkingUpto,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('factory_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
                        
                                $data = array('post_id'=>$post_id,
                                              'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                              'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                              'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                              'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                              'Lift'=>(!empty($lilft)) ? 1 : 0,
                                              'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                              'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                              'Security'=>(!empty($security)) ? 1 : 0,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('commercial_amenities', $data);
                   			}
                		}
                	}
                }
                
                else if($form_data['residential'] == "Land")
                {
                    $this->load->library('upload');
                    $this->load->library('PHPReport');
                    $this->load->helper('download');
                	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
                	$configUpload['allowed_types'] = 'xls|xlsx';
                	$configUpload['max_size'] = '0';
                	$this->upload->initialize($configUpload);
                	$this->upload->do_upload('lead_partner');
                	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
                	$file_name = $upload_data['file_name']; //uploded file name
                	$extension=$upload_data['file_ext'];    // uploded file extension
                	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
                	$objReader->setReadDataOnly(false);
                	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
                	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
                	{
                		$worksheet_index=$objPHPExcel->getIndex($worksheet);
            			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
            			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
            			if($highestRow > 0)
            			{
            		        for($cl=2;$cl<=$highestRow;$cl++)
            		        {
            		            $lead_partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
                    			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
                    			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
                    			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
                    			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
                    			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
                    			$state = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
                    			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
                    			$location = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
                    			$complex = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
                    			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
                    			$block_no = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
                    			$landmark = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
                    			$flat_no = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
                    			$pincode = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
                    			$ready_to_move = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
                    			$age_of_prop = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
                    			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) != NULL ? 
                    			date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(17,$cl)->getValue())) : '';
                    			$property_type = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
                    			$open_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    			$covered_parking = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
                    			$basement = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
                    			$lift_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
                    			$two_v_parking = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
                    			$furnish_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
                    			$net_amount = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
                    			$booking_ant = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
                    			$LandArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
                    			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
                    			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
                    			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
                    			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
                    			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
                    			$LandStatus = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
                    			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
                    			$NatureofLand = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
                    			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
                    			$PropertyTax = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
                    			$Mutation = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
                    			$LandFacing = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
                   
                                $random_name = rand(10000,999999);
                                $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                                $newmaxid = $maxid+1;
                                $nozero = 7 - strlen($maxid);
                                $zeros = '';
                                for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                                $lead_id = "PRT".$zeros.$newmaxid;
                                
                                $data = array(
                                    'user_id' => $lead_partner_id,
                                    'user_type'=> 'lead_partner',
                                    'lead_id'=>$lead_id,
                                    'name'=> $name,
                                    'mobile'=> $mobile,
                                    'phone'=> $phone,
                                    'mobile1'=> $mobile1,
                                    'email'=> $email,
                                    'state'=> $state,
                                    'location'=> $location,
                                    'city'=> $city,
                                    'complex_society_building'=> $complex,
                                    'address'=> $address,
                                    'blockno'=> $block_no,
                                    'landmark'=> $landmark,
                                    'flatno'=> $flat_no,
                                    'pincode'=> $pincode,
                                    'status'=>1,
                                    'created'=>date('Y-m-d'),
                                    'refresh_date'=>date('Y-m-d'),
                                );
                                $post_id = $this->Common_model->insert_data('post_property', $data);
                                $data = array(
                                        'post_id'=>$post_id,
                                        'rent_sell'=> 'Rent',
                                        'res_com'=> 'Commercial',
                                        'FurnishedStatus'=> $furnish_status,
                                        'residential'=> 'Land',
                                        'security_deposite'=> $net_amount,
                                        'rentPerMonth'=> $booking_ant,
                                        'created'=>date('Y-m-d'),
                                        );
                                $res = $this->Common_model->insert_data('property_type', $data);
                                
                                
                                $data = array('post_id'=>$post_id,
                                               'LandArea'=> $LandArea,
                                              'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                              'landCoveredArea'=> $landCoveredArea,
                                              'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                              'LandRoadWide'=> $LandRoadWide,
                                              'LandRoadWideUnit'=> $LandRoadWideUnit,
                                              'LandStatus'=> $LandStatus,
                                              'IstheExistingOwner'=> $IstheExistingOwner,
                                              'NatureofLand'=> $NatureofLand,
                                              'NoOfOwner'=> $NoOfOwner,
                                              'PropertyTax'=> $PropertyTax,
                                              'Mutation'=> $Mutation,
                                              'LandFacing'=> $LandFacing,
                                              'created'=>date('Y-m-d'),
                                             );
                                $res = $this->Common_model->insert_data('land_details', $data);
                                
                                $data = array(
                                        'post_id'=>$post_id,
                                        'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                                        'AgeofPropeety'=> $age_of_prop . ' Year Old',
                                        'PossessionDate'=> $possession_date,
                                        'PropertyType'=> $property_type,
                                        'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                                        'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                                        'Basement'=>!empty($basement) ? $basement : 0,
                                        'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                                        'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                                        'created'=>date('Y-m-d'),
                                    );
                                $res = $this->Common_model->insert_data('other_details', $data);
            
                   			}
                		}
                	}
                }
            }
        }
        
        unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/sellers_lead');
    }
    
    public function home_loan_leads()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
		            $partner_id = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$name = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$country = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$loan_required_upto = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$company_name = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$bank = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$emp_type = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$annualIncome = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$comment = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$res_com = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$residential = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
                    
                    $maxid = $this->Common_model->selectmaxid('id', array(), 'home_loan');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "HLN".$zeros.($maxid+1);
                    $insert_data = array(
                        'lead_id'=>$lead_id,
                        'user_id'=>$partner_id,
                        'user_type'=> 'lead_partner',
                        'name'=> $name,
                        'mobile'=>$mobile,
                        'mobile2'=>$mobile1,
                        'email'=>$email, 
                        'country'=>$country,
                        'city'=>$city,
                        'pincode'=>$pincode,
                        'state'=>$state, 
                        'Address'=>$address,
                        'location'=>$location,
                        'LoanRequiredUpto'=>$loan_required_upto, 
                        'companyname'=>$company_name,
                        'bank'=>$bank,
                        'employmentType'=>$emp_type,
                        'annualIncome'=>$annualIncome,
                        'comment'=>$comment,
                        'created'=>date('Y-m-d H:i:s'),
                        'res_com' => $res_com,
                        'residential' => $residential);
                    $this->Common_model->insert_data('home_loan',$insert_data);
       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/home_lead');
    }
    
    
    // Sell
    public function saller_res_sale_flat()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Flat',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    $data = array(
                        'post_id'=> $post_id,
                        'flat_Room'=> $flat_rooms,
                        'flat_Balcony'=> $balcony,
                        'flat_SuperBuildupArea'=> $subper_built_up,
                        'flat_CarpetArea'=> $carpet_area,
                        'flat_SuperBuildupAreaUnit'=> $supper_b_unit,
                        'flat_Carpet_Unit'=> $carpet_area_unit,
                        'flat_TotalFloor'=> $total_floor,
                        'flat_Bathroom'=> $bathrooms,
                        'flat_Kitchen'=> $kitchen,
                        'flat_BuildupArea'=> $bulid_up,
                        'flat_BuildupArea_Unit'=> $build_up_unit,
                        'flat_Floor'=> $flat_floor,
                        'created'=>date('Y-m-d'),
                    );
                    $res = $this->Common_model->insert_data('flat_details', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_sale_flat');
    }
    
    public function saller_res_house_bunglow()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			
        			$total_land_area = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$total_land_area_unit = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$total_uncovered_area_unit = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$covered_area = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$covered_area_unit = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'HouseorBanglow',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    $data = array('post_id'=>$post_id,
                                  'house_Room'=> $flat_rooms,
                                  'house_Bathroom'=> $bathrooms,
                                  'house_Balcony'=> $balcony,
                                  'house_Kitchen'=> $kitchen,
                                  'house_TotalFloor'=> $total_floor,
                                  'house_SuperBuildupArea'=> $subper_built_up,
                                  'house_SuperBuildupArea_Unit'=> $supper_b_unit,
                                  'house_BuildupArea'=> $bulid_up,
                                  'house_BuildupAreaUnit'=> $build_up_unit,
                                    'house_CarpetArea'=> $carpet_area,
                                   'house_Carpet_Unit'=> $carpet_area_unit,
                                   'house_TotalLandArea'=> $total_land_area,
                                   'house_TotalLandArea_Unit'=> $total_land_area_unit,
                                   'house_TotalUncoveredLandArea'=> $total_uncovered_area,
                                  'house_TotalUncoveredLandArea_Unit'=>$total_uncovered_area_unit,
                                  'house_TotalCoveredLandArea'=> $covered_area,
                                  'house_TotalCoveredLandArea_unit'=> $covered_area_unit,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('house_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_sale_house_bunglow');
    }
    
    function saller_res_sale_pent_house()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			
        			$open_terrace = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$open_terrace_unit = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'PentHouse',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                              'pent_room'=> $flat_rooms,
                              'pent_bathroom'=> $bathrooms,
                              'pent_balcony'=> $balcony,
                              'pent_kitchen'=> $kitchen,
                              'pent_floor'=> $flat_floor,
                              'total_floor'=> $total_floor,
                              'pent_super_buildup_area'=> $subper_built_up,
                              'pent_super_buildup_area_Unit'=> $supper_b_unit,
                              'pent_buildup_area'=> $bulid_up,
                              'pent_buildup_area_Unit'=> $build_up_unit,
                              'pent_carpet_area'=> $carpet_area,
                              'pent_carpet_unit'=> $carpet_area_unit,
                              'open_terrace'=> $open_terrace,
                              'pent_open_terrace_unit'=> $open_terrace_unit,
                              'created'=>date('Y-m-d'),
                             );
                $res = $this->Common_model->insert_data('pent_house_details', $data);
                
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_sale_pent_house');
    }

    function saller_res_sale_duplex_flat()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			
        			$lower_floor_no = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$upperfloorno = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'DuplexFlat',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'room'=> $flat_rooms,
                                  'bathroom'=> $bathrooms,
                                  'balcony'=> $balcony,
                                  'kitchen'=> $kitchen,
                                  'lower_floor_no'=> $lower_floor_no,
                                  'upperfloorno'=> $upperfloorno,
                                  'totalfloor'=> $total_floor,
                                  'super_buildup_area'=> $subper_built_up,
                                  'super_buildup_area_unit'=> $supper_b_unit,
                                  'buildup_area'=> $bulid_up,
                                  'buildup_area_Unit'=> $build_up_unit,
                                  'carpet_area'=> $carpet_area,
                                  'carpet_unit'=> $carpet_area_unit,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('duplex_flat_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_sale_duplex_flat');
    }
    
    function saller_res_sale_land()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$LandArea = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$LandStatus = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$NatureofLand = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$PropertyTax = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$Mutation = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$LandFacing = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Land',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    
                    $data = array('post_id'=>$post_id,
                                   'LandArea'=> $LandArea,
                                  'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                  'landCoveredArea'=> $landCoveredArea,
                                  'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                  'LandRoadWide'=> $LandRoadWide,
                                  'LandRoadWideUnit'=> $LandRoadWideUnit,
                                  'LandStatus'=> $LandStatus,
                                  'IstheExistingOwner'=> $IstheExistingOwner,
                                  'NatureofLand'=> $NatureofLand,
                                  'NoOfOwner'=> $NoOfOwner,
                                  'PropertyTax'=> $PropertyTax,
                                  'Mutation'=> $Mutation,
                                  'LandFacing'=> $LandFacing,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('land_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_sale_land');
    }
    
    //Rent
    public function saller_res_rent_flat()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array('security_deposite'=> $net_amount,
                                  'rentPerMonth'=> $booking_ant,
                                  'post_id'=>$post_id,
                                  'rent_sell'=> 'Rent',
                                  'res_com'=> 'Residential',
                                  'FurnishedStatus'=> $furnish_status,
                                  'residential'=> 'Flat',
                                  'created'=>date('Y-m-d'),
                                );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    $data = array(
                        'post_id'=> $post_id,
                        'flat_Room'=> $flat_rooms,
                        'flat_Balcony'=> $balcony,
                        'flat_SuperBuildupArea'=> $subper_built_up,
                        'flat_CarpetArea'=> $carpet_area,
                        'flat_SuperBuildupAreaUnit'=> $supper_b_unit,
                        'flat_Carpet_Unit'=> $carpet_area_unit,
                        'flat_TotalFloor'=> $total_floor,
                        'flat_Bathroom'=> $bathrooms,
                        'flat_Kitchen'=> $kitchen,
                        'flat_BuildupArea'=> $bulid_up,
                        'flat_BuildupArea_Unit'=> $build_up_unit,
                        'flat_Floor'=> $flat_floor,
                        'created'=>date('Y-m-d'),
                    );
                    $res = $this->Common_model->insert_data('flat_details', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_rent_flat');
    }
    
    public function saller_res_rent_house_bunglow()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			
        			$total_land_area = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$total_land_area_unit = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$total_uncovered_area_unit = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$covered_area = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$covered_area_unit = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                        
                        'security_deposite'=> $net_amount,
                                  'rentPerMonth'=> $booking_ant,
                                  'post_id'=>$post_id,
                                  'rent_sell'=> 'Rent',
                                  'res_com'=> 'Residential',
                                  'FurnishedStatus'=> $furnish_status,
                                  'residential'=> 'HouseorBanglow',
                                  'created'=>date('Y-m-d'),
                        
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    $data = array('post_id'=>$post_id,
                                  'house_Room'=> $flat_rooms,
                                  'house_Bathroom'=> $bathrooms,
                                  'house_Balcony'=> $balcony,
                                  'house_Kitchen'=> $kitchen,
                                  'house_TotalFloor'=> $total_floor,
                                  'house_SuperBuildupArea'=> $subper_built_up,
                                  'house_SuperBuildupArea_Unit'=> $supper_b_unit,
                                  'house_BuildupArea'=> $bulid_up,
                                  'house_BuildupAreaUnit'=> $build_up_unit,
                                    'house_CarpetArea'=> $carpet_area,
                                   'house_Carpet_Unit'=> $carpet_area_unit,
                                   'house_TotalLandArea'=> $total_land_area,
                                   'house_TotalLandArea_Unit'=> $total_land_area_unit,
                                   'house_TotalUncoveredLandArea'=> $total_uncovered_area,
                                  'house_TotalUncoveredLandArea_Unit'=>$total_uncovered_area_unit,
                                  'house_TotalCoveredLandArea'=> $covered_area,
                                  'house_TotalCoveredLandArea_unit'=> $covered_area_unit,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('house_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_rent_house_bunglow');
    }
    
    function saller_res_rent_pent_house()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			
        			$open_terrace = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$open_terrace_unit = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                        
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'PentHouse',
                            'security_deposite'=> $net_amount,
                                  'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                              'pent_room'=> $flat_rooms,
                              'pent_bathroom'=> $bathrooms,
                              'pent_balcony'=> $balcony,
                              'pent_kitchen'=> $kitchen,
                              'pent_floor'=> $flat_floor,
                              'total_floor'=> $total_floor,
                              'pent_super_buildup_area'=> $subper_built_up,
                              'pent_super_buildup_area_Unit'=> $supper_b_unit,
                              'pent_buildup_area'=> $bulid_up,
                              'pent_buildup_area_Unit'=> $build_up_unit,
                              'pent_carpet_area'=> $carpet_area,
                              'pent_carpet_unit'=> $carpet_area_unit,
                              'open_terrace'=> $open_terrace,
                              'pent_open_terrace_unit'=> $open_terrace_unit,
                              'created'=>date('Y-m-d'),
                             );
                $res = $this->Common_model->insert_data('pent_house_details', $data);
                
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_rent_pent_house');
    }
    
    function saller_res_rent_duplex_flat()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$flat_rooms = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$flat_floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$powerbackups = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$ServiveLift = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$BanquetHall = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$GYM = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$VisitorParking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$Intercom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$CCTV = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$SwimmingPool = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$CloubHouse = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$SarvantRoom = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$Lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$WIFI = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$CommunityHall = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$IndoorGame = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$OutDoorGame = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$GasPipeLine = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$Park = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$Security = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			
        			$lower_floor_no = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$upperfloorno = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'DuplexFlat',

                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'room'=> $flat_rooms,
                                  'bathroom'=> $bathrooms,
                                  'balcony'=> $balcony,
                                  'kitchen'=> $kitchen,
                                  'lower_floor_no'=> $lower_floor_no,
                                  'upperfloorno'=> $upperfloorno,
                                  'totalfloor'=> $total_floor,
                                  'super_buildup_area'=> $subper_built_up,
                                  'super_buildup_area_unit'=> $supper_b_unit,
                                  'buildup_area'=> $bulid_up,
                                  'buildup_area_Unit'=> $build_up_unit,
                                  'carpet_area'=> $carpet_area,
                                  'carpet_unit'=> $carpet_area_unit,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('duplex_flat_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbackups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($ServiveLift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($BanquetHall)) ? 1 : 0,
                                  'GYM'=>(!empty($GYM)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($VisitorParking)) ? 1 : 0,
                                  'Intercom'=>(!empty($Intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($CCTV)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($SwimmingPool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($CloubHouse)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($SarvantRoom)) ? 1 : 0,
                                  'Lift'=>(!empty($Lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($WIFI)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($CommunityHall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($IndoorGame)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($OutDoorGame)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($GasPipeLine)) ? 1 : 0,
                                  'Park'=>(!empty($Park)) ? 1 : 0,
                                  'Security'=>(!empty($Security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                $res = $this->Common_model->insert_data('residential_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_rent_duplex_flat');
    }
    
    function saller_res_rent_land()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$LandArea = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$LandStatus = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$NatureofLand = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$PropertyTax = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$Mutation = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$LandFacing = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Residential',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Land',
                            
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            
                            'per_unit'=>!empty($post['per_unit']) ? $post['per_unit'] : '',
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    
                    $data = array('post_id'=>$post_id,
                                   'LandArea'=> $LandArea,
                                  'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                  'landCoveredArea'=> $landCoveredArea,
                                  'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                  'LandRoadWide'=> $LandRoadWide,
                                  'LandRoadWideUnit'=> $LandRoadWideUnit,
                                  'LandStatus'=> $LandStatus,
                                  'IstheExistingOwner'=> $IstheExistingOwner,
                                  'NatureofLand'=> $NatureofLand,
                                  'NoOfOwner'=> $NoOfOwner,
                                  'PropertyTax'=> $PropertyTax,
                                  'Mutation'=> $Mutation,
                                  'LandFacing'=> $LandFacing,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('land_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_residential_rent_land');
    }
    
    
    //Comm
    function saller_com_sell_office()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$no_cabins = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$no_of_work_stations = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$ac = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$Bathrooms = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Office',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'officeNumberofCabin'=> $no_cabins,
                                  'officeNumberofWorkStation'=> $no_of_work_stations,
                                  'officeSuperBuildupArea'=> $subper_built_up,
                                  'officeSuperBuildupAreaUnit'=> $supper_b_unit,
                                  'officeBuildupArea'=> $bulid_up,
                                  'officeBuildupAreaUnit'=> $build_up_unit,
                                  'officeCarpetArea'=> $carpet_area,
                                  'officeCarpetUnit'=>$carpet_area_unit,
                                  'officeAC'=>$ac,
                                  'Flooroffice'=> $floor,
                                  'officeTotalFloor'=> $total_floor,
                                  'Pentryoffice'=> $pentry,
                                  'PentryofficeUsedFor'=> $pentry_user_for,
                                  'officeBathroom'=> $Bathrooms,
                                  'BathroomofficeUsedFor'=>$bathrooms_used_for,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('office_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_sale_office');
    }
    
    function saller_com_rent_office()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$no_cabins = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$no_of_work_stations = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$subper_built_up = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$ac = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$floor = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$Bathrooms = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
       
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Office',
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'officeNumberofCabin'=> $no_cabins,
                                  'officeNumberofWorkStation'=> $no_of_work_stations,
                                  'officeSuperBuildupArea'=> $subper_built_up,
                                  'officeSuperBuildupAreaUnit'=> $supper_b_unit,
                                  'officeBuildupArea'=> $bulid_up,
                                  'officeBuildupAreaUnit'=> $build_up_unit,
                                  'officeCarpetArea'=> $carpet_area,
                                  'officeCarpetUnit'=>$carpet_area_unit,
                                  'officeAC'=>$ac,
                                  'Flooroffice'=> $floor,
                                  'officeTotalFloor'=> $total_floor,
                                  'Pentryoffice'=> $pentry,
                                  'PentryofficeUsedFor'=> $pentry_user_for,
                                  'officeBathroom'=> $Bathrooms,
                                  'BathroomofficeUsedFor'=>$bathrooms_used_for,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('office_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_rent_office');
    }
    
    function saller_com_sell_shop()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$shoproof = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$shopFrontage = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$shopFrontageUnit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$shopSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$shopSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$shopBuildupArea = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$shopBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$shopCoveredArea = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$shopCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$shopOpenArea = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$shopOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$shopFloor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$shopTotalFloor = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$shopBathroom = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$shopBathroomUnit = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$shopPentry = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$shopRoadWide = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$shopRoadWideUnit = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$shopElectricPower = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$shopElectricPowerUnit = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$shopAvailableForBar = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$shopForResturant = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$shopHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'ShopOrShowroom',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'shoproof'=>$shoproof,
                                  'shopFrontage'=>$shopFrontage,
                                  'shopFrontageUnit'=>$shopFrontageUnit,
                                  'shopSuperBuildupArea'=>$shopSuperBuildupArea,
                                  'shopSuperBuildupAreaUnit'=>$shopSuperBuildupAreaUnit,
                                  'shopBuildupArea'=>$shopBuildupArea,
                                  'shopBuildupAreaUnit'=>$shopBuildupAreaUnit,
                                  'shopCoveredArea'=>$shopCoveredArea,
                                  'shopCoveredAreaUnit'=>$shopCoveredAreaUnit,
                                  'shopOpenArea'=>$shopOpenArea,
                                  'shopOpenAreaUnit'=>$shopOpenAreaUnit,
                                  'shopFloor'=>$shopFloor,
                                  'shopTotalFloor'=>$shopTotalFloor,
                                  'shopBathroom'=>$shopBathroom,
                                  'shopBathroomUnit'=>$shopBathroomUnit,
                                  'shopPentry'=>$shopPentry,
                                  'shopPentryUsedFor'=>$shopPentryUsedFor,
                                  'shopRoadWide'=>$shopRoadWide,
                                  'shopRoadWideUnit'=>$shopRoadWideUnit,
                                  'shopElectricPower'=>$shopElectricPower,
                                  'shopElectricPowerUnit'=>$shopElectricPowerUnit,
                                  'shopAvailableForBar'=>$shopAvailableForBar,
                                  'shopForResturant'=>$shopForResturant,
                                  'shopHeavyVehicleParkingUpto'=>$shopHeavyVehicleParkingUpto,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('shop_details', $data);
                    
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_sale_shop_showroom');
    }
    
    function saller_com_rent_shop()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$shoproof = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$shopFrontage = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$shopFrontageUnit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$shopSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$shopSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$shopBuildupArea = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$shopBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$shopCoveredArea = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$shopCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$shopOpenArea = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$shopOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$shopFloor = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$shopTotalFloor = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$shopBathroom = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$shopBathroomUnit = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$shopPentry = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$shopRoadWide = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$shopRoadWideUnit = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$shopElectricPower = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$shopElectricPowerUnit = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$shopAvailableForBar = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$shopForResturant = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$shopHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'ShopOrShowroom',
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'shoproof'=>$shoproof,
                                  'shopFrontage'=>$shopFrontage,
                                  'shopFrontageUnit'=>$shopFrontageUnit,
                                  'shopSuperBuildupArea'=>$shopSuperBuildupArea,
                                  'shopSuperBuildupAreaUnit'=>$shopSuperBuildupAreaUnit,
                                  'shopBuildupArea'=>$shopBuildupArea,
                                  'shopBuildupAreaUnit'=>$shopBuildupAreaUnit,
                                  'shopCoveredArea'=>$shopCoveredArea,
                                  'shopCoveredAreaUnit'=>$shopCoveredAreaUnit,
                                  'shopOpenArea'=>$shopOpenArea,
                                  'shopOpenAreaUnit'=>$shopOpenAreaUnit,
                                  'shopFloor'=>$shopFloor,
                                  'shopTotalFloor'=>$shopTotalFloor,
                                  'shopBathroom'=>$shopBathroom,
                                  'shopBathroomUnit'=>$shopBathroomUnit,
                                  'shopPentry'=>$shopPentry,
                                  'shopPentryUsedFor'=>$shopPentryUsedFor,
                                  'shopRoadWide'=>$shopRoadWide,
                                  'shopRoadWideUnit'=>$shopRoadWideUnit,
                                  'shopElectricPower'=>$shopElectricPower,
                                  'shopElectricPowerUnit'=>$shopElectricPowerUnit,
                                  'shopAvailableForBar'=>$shopAvailableForBar,
                                  'shopForResturant'=>$shopForResturant,
                                  'shopHeavyVehicleParkingUpto'=>$shopHeavyVehicleParkingUpto,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('shop_details', $data);
                    
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_rent_shop_showroom');
    }
    
    function saller_com_sell_warehouse()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$warehouseCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$warehouseroof = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    $shopPentry = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			
                    
                    
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Warehouse',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'warehouseNumberofCabin'=>$warehouseNumberofCabin,
                                  'warehouseSuperBuildupArea'=>$warehouseSuperBuildupArea,
                                  'warehouseSuperBuildupAreaUnit'=>$warehouseSuperBuildupAreaUnit,
                                  'warehouseCoveredAreaUnit'=>$warehouseCoveredAreaUnit,
                                  'warehouseFloor'=>$warehouseFloor,
                                  'warehouseroof'=>$warehouseroof,
                                  'warehouseRoadWide'=>$warehouseRoadWide,
                                  'warehouseRoadWideUnit'=>$warehouseRoadWideUnit,
                                  'warehouseHeavyVehicleParkingUpto'=>$warehouseHeavyVehicleParkingUpto,
                                  'warehouseNumberofWorkStation'=>$warehouseNumberofWorkStation,
                                  'warehouseBuildupArea'=>$warehouseBuildupArea,
                                  'warehouseOpenArea'=>$warehouseOpenArea,
                                  
                                  'warehouseBuildupAreaUnit'=>$warehouseBuildupAreaUnit,
                                  'warehouseOpenAreaUnit'=>$warehouseOpenAreaUnit,
                                  'warehouseTotalFloor'=>$warehouseTotalFloor,
                                  'warehousePentry'=> $shopPentry,
                                  'warehouseBathroom'=>$warehouseBathroom,
                                  'warehousePentryUsedFor'=>$shopPentryUsedFor,
                                  'warehouseBathroomUsedFor'=>$warehouseBathroomUsedFor,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('warehouse_details', $data);
                    
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_sale_warehouse');
    }
    
    function saller_com_rent_warehouse()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$warehouseCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$warehouseroof = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
                    $shopPentry = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			
                    
                    
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Warehouse',
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    $data = array('post_id'=>$post_id,
                                  'warehouseNumberofCabin'=>$warehouseNumberofCabin,
                                  'warehouseSuperBuildupArea'=>$warehouseSuperBuildupArea,
                                  'warehouseSuperBuildupAreaUnit'=>$warehouseSuperBuildupAreaUnit,
                                  'warehouseCoveredAreaUnit'=>$warehouseCoveredAreaUnit,
                                  'warehouseFloor'=>$warehouseFloor,
                                  'warehouseroof'=>$warehouseroof,
                                  'warehouseRoadWide'=>$warehouseRoadWide,
                                  'warehouseRoadWideUnit'=>$warehouseRoadWideUnit,
                                  'warehouseHeavyVehicleParkingUpto'=>$warehouseHeavyVehicleParkingUpto,
                                  'warehouseNumberofWorkStation'=>$warehouseNumberofWorkStation,
                                  'warehouseBuildupArea'=>$warehouseBuildupArea,
                                  'warehouseOpenArea'=>$warehouseOpenArea,
                                  
                                  'warehouseBuildupAreaUnit'=>$warehouseBuildupAreaUnit,
                                  'warehouseOpenAreaUnit'=>$warehouseOpenAreaUnit,
                                  'warehouseTotalFloor'=>$warehouseTotalFloor,
                                  'warehousePentry'=> $shopPentry,
                                  'warehouseBathroom'=>$warehouseBathroom,
                                  'warehousePentryUsedFor'=>$shopPentryUsedFor,
                                  'warehouseBathroomUsedFor'=>$warehouseBathroomUsedFor,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('warehouse_details', $data);
                    
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_rent_warehouse');
    }
    
    function saller_com_sell_factory()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$factory_carpet_area = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$factory_carpet_area_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$ManufacturingType = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    $shopPentry = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			
        			$security = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$ElectricPower = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			
        			
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Factory',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);

                    
                    $data = array('post_id'=>$post_id,'factory_numberofcabin'=>$warehouseNumberofCabin,
                                  'factory_super_buildup_area'=>$warehouseSuperBuildupArea,
                                  'factory_carpet_area'=>$factory_carpet_area,
                                  'factory_super_buildup_area_unit'=>$warehouseSuperBuildupAreaUnit,
                                  'factory_carpet_unit'=>$factory_carpet_unit,
                                  'factory_floor'=> $warehouseFloor,
                                  'factory_pentry'=> $shopPentry,
                                  'factory_roadWide'=> $warehouseRoadWide,
                                  'factory_pentry_usedFor'=> $shopPentryUsedFor,
                                  'factory_roadWide_unit'=> $warehouseRoadWideUnit,
                                  'factory_ManufacturingType'=> $ManufacturingType,
                                  'factory_NumberofWorkStation'=> $warehouseNumberofWorkStation,
                                  'factory_BuildupArea'=> $warehouseBuildupArea,
                                  'factory_OpenArea'=> $warehouseOpenArea,
                                  'factory_BuildupAreaUnit'=> $warehouseBuildupAreaUnit,
                                  'factory_OpenAreaUnit'=> $warehouseOpenAreaUnit,
                                  'factory_TotalFloor'=> $warehouseTotalFloor,
                                  'factory_Bathroom'=> $warehouseBathroom,
                                  'factory_ElectricPower'=> $ElectricPower,
                                  'factory_Bathroom_UsedFor'=> $warehouseBathroomUsedFor,
                                  'factory_HeavyVehicleParkingUpto'=> $warehouseHeavyVehicleParkingUpto,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('factory_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);
       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_sale_factory');
    }
    
    function saller_com_rent_factory()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$warehouseNumberofCabin = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$warehouseSuperBuildupArea = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$warehouseSuperBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$factory_carpet_area = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$factory_carpet_area_unit = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$warehouseFloor = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$warehouseTotalFloor = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$ManufacturingType = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$warehouseRoadWide = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$warehouseRoadWideUnit = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$warehouseHeavyVehicleParkingUpto = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$warehouseNumberofWorkStation = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$warehouseBuildupArea = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$warehouseBuildupAreaUnit = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$warehouseOpenArea = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$warehouseOpenAreaUnit = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
                    $shopPentry = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$shopPentryUsedFor = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$warehouseBathroom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$warehouseBathroomUsedFor = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			
        			$security = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$powerbk = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$lilft = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$service_lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$intercome = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$ElectricPower = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			
        			
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Factory',
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);

                    
                    $data = array('post_id'=>$post_id,'factory_numberofcabin'=>$warehouseNumberofCabin,
                                  'factory_super_buildup_area'=>$warehouseSuperBuildupArea,
                                  'factory_carpet_area'=>$factory_carpet_area,
                                  'factory_super_buildup_area_unit'=>$warehouseSuperBuildupAreaUnit,
                                  'factory_carpet_unit'=>$factory_carpet_unit,
                                  'factory_floor'=> $warehouseFloor,
                                  'factory_pentry'=> $shopPentry,
                                  'factory_roadWide'=> $warehouseRoadWide,
                                  'factory_pentry_usedFor'=> $shopPentryUsedFor,
                                  'factory_roadWide_unit'=> $warehouseRoadWideUnit,
                                  'factory_ManufacturingType'=> $ManufacturingType,
                                  'factory_NumberofWorkStation'=> $warehouseNumberofWorkStation,
                                  'factory_BuildupArea'=> $warehouseBuildupArea,
                                  'factory_OpenArea'=> $warehouseOpenArea,
                                  'factory_BuildupAreaUnit'=> $warehouseBuildupAreaUnit,
                                  'factory_OpenAreaUnit'=> $warehouseOpenAreaUnit,
                                  'factory_TotalFloor'=> $warehouseTotalFloor,
                                  'factory_Bathroom'=> $warehouseBathroom,
                                  'factory_ElectricPower'=> $ElectricPower,
                                  'factory_Bathroom_UsedFor'=> $warehouseBathroomUsedFor,
                                  'factory_HeavyVehicleParkingUpto'=> $warehouseHeavyVehicleParkingUpto,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('factory_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);
            
                    $data = array('post_id'=>$post_id,
                                  'PowerBackup'=>(!empty($powerbk)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($service_lift)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercome)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'Lift'=>(!empty($lilft)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('commercial_amenities', $data);
       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_rent_factory');
    }
    
    function saller_com_sell_land()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$LandArea = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$LandStatus = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$NatureofLand = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$PropertyTax = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$Mutation = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$LandFacing = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Sell',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Land',
                            'net_amount'=> $net_amount,
                            'amount'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    
                    $data = array('post_id'=>$post_id,
                                   'LandArea'=> $LandArea,
                                  'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                  'landCoveredArea'=> $landCoveredArea,
                                  'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                  'LandRoadWide'=> $LandRoadWide,
                                  'LandRoadWideUnit'=> $LandRoadWideUnit,
                                  'LandStatus'=> $LandStatus,
                                  'IstheExistingOwner'=> $IstheExistingOwner,
                                  'NatureofLand'=> $NatureofLand,
                                  'NoOfOwner'=> $NoOfOwner,
                                  'PropertyTax'=> $PropertyTax,
                                  'Mutation'=> $Mutation,
                                  'LandFacing'=> $LandFacing,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('land_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_sale_land');
    }
    
    function saller_com_rent_land()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$address = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$block_no = $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(10,$cl)->getValue() : '';
        			$landmark = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$flat_no = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$pincode = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$age_of_prop = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(16,$cl)->getValue())) : '';
        			$property_type = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$open_parking = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$covered_parking = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$basement = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$two_v_parking = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$furnish_status = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$net_amount = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$booking_ant = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			
        			$LandArea = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$land_SuperBuildupArea_Unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$landCoveredArea = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$landCoveredAreaUnit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$LandRoadWide = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$LandRoadWideUnit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$LandStatus = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$IstheExistingOwner = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$NatureofLand = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$NoOfOwner = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$PropertyTax = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$Mutation = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$LandFacing = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
       
                    $random_name = rand(10000,999999);
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_property');
                    $newmaxid = $maxid+1;
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = "PRT".$zeros.$newmaxid;
                    
                    $data = array(
                        'user_id'=>$this->session->userdata('admin_id'),
                        'user_type'=>$this->session->userdata('user_type'),
                        'lead_id'=>$lead_id,
                        'name'=> $name,
                        'mobile'=> $mobile,
                        'phone'=> $phone,
                        'mobile1'=> $mobile1,
                        'email'=> $email,
                        'state'=> $state,
                        'location'=> $location,
                        'city'=> $city,
                        'complex_society_building'=> $complex,
                        'address'=> $address,
                        'blockno'=> $block_no,
                        'landmark'=> $landmark,
                        'flatno'=> $flat_no,
                        'pincode'=> $pincode,
                        'status'=>1,
                        'created'=>date('Y-m-d'),
                        'refresh_date'=>date('Y-m-d'),
                    );
                    $post_id = $this->Common_model->insert_data('post_property', $data);
                    $data = array(
                            'post_id'=>$post_id,
                            'rent_sell'=> 'Rent',
                            'res_com'=> 'Commercial',
                            'FurnishedStatus'=> $furnish_status,
                            'residential'=> 'Land',
                            'security_deposite'=> $net_amount,
                            'rentPerMonth'=> $booking_ant,
                            'created'=>date('Y-m-d'),
                            );
                    $res = $this->Common_model->insert_data('property_type', $data);
                    
                    
                    $data = array('post_id'=>$post_id,
                                   'LandArea'=> $LandArea,
                                  'land_SuperBuildupArea_Unit'=> $land_SuperBuildupArea_Unit,
                                  'landCoveredArea'=> $landCoveredArea,
                                  'landCoveredAreaUnit'=> $landCoveredAreaUnit,
                                  'LandRoadWide'=> $LandRoadWide,
                                  'LandRoadWideUnit'=> $LandRoadWideUnit,
                                  'LandStatus'=> $LandStatus,
                                  'IstheExistingOwner'=> $IstheExistingOwner,
                                  'NatureofLand'=> $NatureofLand,
                                  'NoOfOwner'=> $NoOfOwner,
                                  'PropertyTax'=> $PropertyTax,
                                  'Mutation'=> $Mutation,
                                  'LandFacing'=> $LandFacing,
                                  'created'=>date('Y-m-d'),
                                 );
                    $res = $this->Common_model->insert_data('land_details', $data);
                    
                    $data = array(
                            'post_id'=>$post_id,
                            'section'=> !empty($ready_to_move) ? 'ReadyToMove' : 'PossessionFrom',
                            'AgeofPropeety'=> $age_of_prop . ' Year Old',
                            'PossessionDate'=> $possession_date,
                            'PropertyType'=> $property_type,
                            'OpenParking'=> !empty($open_parking) ? $open_parking : 0,
                            'CoveredParking'=>!empty($covered_parking) ? $covered_parking : 0,
                            'Basement'=>!empty($basement) ? $basement : 0,
                            'LiftParking'=>!empty($lift_parking) ? $lift_parking : 0,
                            'TwoWheeler'=>!empty($two_v_parking) ? $two_v_parking : 0,
                            'created'=>date('Y-m-d'),
                        );
                    $res = $this->Common_model->insert_data('other_details', $data);

       			}
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/seller_commercial_rent_land');
    }
   
    function RandomString()
    {
        $characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        $randstring = '';
        for ($i = 0; $i < 2; $i++) {
            $randstring = strtoupper($characters[rand(0, strlen($characters))]);
        }
        return $randstring;
    }
   //Buyer Sell
   
    function buyer_res_sell_flat()
    {
        $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Flat',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $duplex_flat = array(
                                     'post_id'=>$result,
                                     'Room'=> $rooms,
                                     'Bathroom'=> $bathrooms,
                                     'FlatMinimumAreaRequired'=> $min_area,
                                     'SuperBuildupAreaUnit'=> $min_area_unit,
                                     'FlatMaximumAreaRequired'=> $max_area,
                                     'BuildupAreaUnit'=> $max_area_unit,
                                     'MinimumFloorHeight'=>$min_floor_hights,
                                     'MaximumFloorHeight'=>$max_floor_hights,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupUnit'=>$supper_b_unit,
                                     'BuildupArea'=>$bulid_up,
                                     'BuildupUnit'=>$build_up_unit,
                                     'CarpetArea'=>$carpet_area,
                                     'CarpetAreaUnit'=>$carpet_area_unit,
                                     'balcony'=>$balcony,
                                     'kitchen'=>$kitchen,
                                     'totalfloor'=>$total_floor,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_sale_flat');
   }
   
    function buyer_res_rent_flat()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Flat',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $duplex_flat = array(
                                     'post_id'=>$result,
                                     'Room'=> $rooms,
                                     'Bathroom'=> $bathrooms,
                                     'FlatMinimumAreaRequired'=> $min_area,
                                     'SuperBuildupAreaUnit'=> $min_area_unit,
                                     'FlatMaximumAreaRequired'=> $max_area,
                                     'BuildupAreaUnit'=> $max_area_unit,
                                     'MinimumFloorHeight'=>$min_floor_hights,
                                     'MaximumFloorHeight'=>$max_floor_hights,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupUnit'=>$supper_b_unit,
                                     'BuildupArea'=>$bulid_up,
                                     'BuildupUnit'=>$build_up_unit,
                                     'CarpetArea'=>$carpet_area,
                                     'CarpetAreaUnit'=>$carpet_area_unit,
                                     'balcony'=>$balcony,
                                     'kitchen'=>$kitchen,
                                     'totalfloor'=>$total_floor,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_rent_flat');
   }
   
    function buyer_res_sell_house()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$total_area = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$total_area_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$total_uncovered_unit = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'HouseOrBanglow',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $house = array(
                             'post_id'=>$result,
                             'HouseRoom'=> $rooms,
                             'HouseBathroom'=> $bathrooms,
                             'SuperBuildupArea'=> $supper_buildup,
                             'SuperBuildupAreaUnit'=> $supper_b_unit,
                             'MinimumAreaRequired'=> $min_area,
                             'StockMinimumAreaRequiredUnit'=>$min_area_unit,
                             'HouseMaximumAreaRequired'=> $max_area,
                             'HouseMaximumOpenAreaUnit'=> $max_area_unit,
                             'CarpetArea'=> $carpet_area,
                             'CarpetUnit'=> $carpet_area_unit,
                             'BuildupArea'=> $bulid_up,
                             'BuildupAreaUnit'=> $build_up_unit,
                             'TotalLandArea'=> $total_area,
                             'TotalLandAreaUnit'=> $total_area_unit,
                             'TotalUncoveredLandArea'=> $total_uncovered_area,
                             'TotalUncoveredLandAreaUnit'=>$total_uncovered_unit,
                             'balcony'=>$balcony,
                             'kitchen'=>$kitchen,
                             'totalfloor'=>$total_floor,
                             'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_house_details',$house);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_sale_house_bunglow');
   }
   
    function buyer_res_rent_house()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$total_area = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$total_area_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$total_uncovered_area = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$total_uncovered_unit = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'HouseOrBanglow',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $house = array(
                             'post_id'=>$result,
                             'HouseRoom'=> $rooms,
                             'HouseBathroom'=> $bathrooms,
                             'SuperBuildupArea'=> $supper_buildup,
                             'SuperBuildupAreaUnit'=> $supper_b_unit,
                             'MinimumAreaRequired'=> $min_area,
                             'StockMinimumAreaRequiredUnit'=>$min_area_unit,
                             'HouseMaximumAreaRequired'=> $max_area,
                             'HouseMaximumOpenAreaUnit'=> $max_area_unit,
                             'CarpetArea'=> $carpet_area,
                             'CarpetUnit'=> $carpet_area_unit,
                             'BuildupArea'=> $bulid_up,
                             'BuildupAreaUnit'=> $build_up_unit,
                             'TotalLandArea'=> $total_area,
                             'TotalLandAreaUnit'=> $total_area_unit,
                             'TotalUncoveredLandArea'=> $total_uncovered_area,
                             'TotalUncoveredLandAreaUnit'=>$total_uncovered_unit,
                             'balcony'=>$balcony,
                             'kitchen'=>$kitchen,
                             'totalfloor'=>$total_floor,
                             'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_house_details',$house);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_rent_house_bunglow');
   }
   
    function buyer_res_sell_penthouse()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'PentHouse',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $duplex_flat = array(
                                     'post_id'=>$result,
                                     'Room'=> $rooms,
                                     'Bathroom'=> $bathrooms,
                                     'FlatMinimumAreaRequired'=> $min_area,
                                     'SuperBuildupAreaUnit'=> $min_area_unit,
                                     'FlatMaximumAreaRequired'=> $max_area,
                                     'BuildupAreaUnit'=> $max_area_unit,
                                     'MinimumFloorHeight'=>$min_floor_hights,
                                     'MaximumFloorHeight'=>$max_floor_hights,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupUnit'=>$supper_b_unit,
                                     'BuildupArea'=>$bulid_up,
                                     'BuildupUnit'=>$build_up_unit,
                                     'CarpetArea'=>$carpet_area,
                                     'CarpetAreaUnit'=>$carpet_area_unit,
                                     'balcony'=>$balcony,
                                     'kitchen'=>$kitchen,
                                     'totalfloor'=>$total_floor,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_sale_pent_house');
   }
   
    function buyer_res_rent_penthouse()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'PentHouse',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $duplex_flat = array(
                                     'post_id'=>$result,
                                     'Room'=> $rooms,
                                     'Bathroom'=> $bathrooms,
                                     'FlatMinimumAreaRequired'=> $min_area,
                                     'SuperBuildupAreaUnit'=> $min_area_unit,
                                     'FlatMaximumAreaRequired'=> $max_area,
                                     'BuildupAreaUnit'=> $max_area_unit,
                                     'MinimumFloorHeight'=>$min_floor_hights,
                                     'MaximumFloorHeight'=>$max_floor_hights,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupUnit'=>$supper_b_unit,
                                     'BuildupArea'=>$bulid_up,
                                     'BuildupUnit'=>$build_up_unit,
                                     'CarpetArea'=>$carpet_area,
                                     'CarpetAreaUnit'=>$carpet_area_unit,
                                     'balcony'=>$balcony,
                                     'kitchen'=>$kitchen,
                                     'totalfloor'=>$total_floor,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_rent_pent_house');
   }
   
    function buyer_res_sell_duplexflat()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'DuplexFlat',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $duplex_flat = array(
                                     'post_id'=>$result,
                                     'Room'=> $rooms,
                                     'Bathroom'=> $bathrooms,
                                     'FlatMinimumAreaRequired'=> $min_area,
                                     'SuperBuildupAreaUnit'=> $min_area_unit,
                                     'FlatMaximumAreaRequired'=> $max_area,
                                     'BuildupAreaUnit'=> $max_area_unit,
                                     'MinimumFloorHeight'=>$min_floor_hights,
                                     'MaximumFloorHeight'=>$max_floor_hights,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupUnit'=>$supper_b_unit,
                                     'BuildupArea'=>$bulid_up,
                                     'BuildupUnit'=>$build_up_unit,
                                     'CarpetArea'=>$carpet_area,
                                     'CarpetAreaUnit'=>$carpet_area_unit,
                                     'balcony'=>$balcony,
                                     'kitchen'=>$kitchen,
                                     'totalfloor'=>$total_floor,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_sale_duplex_flat');
   }
    
    function buyer_res_rent_duplexflat()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rooms = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$balcony = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$kitchen = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$total_floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'DuplexFlat',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $duplex_flat = array(
                                     'post_id'=>$result,
                                     'Room'=> $rooms,
                                     'Bathroom'=> $bathrooms,
                                     'FlatMinimumAreaRequired'=> $min_area,
                                     'SuperBuildupAreaUnit'=> $min_area_unit,
                                     'FlatMaximumAreaRequired'=> $max_area,
                                     'BuildupAreaUnit'=> $max_area_unit,
                                     'MinimumFloorHeight'=>$min_floor_hights,
                                     'MaximumFloorHeight'=>$max_floor_hights,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupUnit'=>$supper_b_unit,
                                     'BuildupArea'=>$bulid_up,
                                     'BuildupUnit'=>$build_up_unit,
                                     'CarpetArea'=>$carpet_area,
                                     'CarpetAreaUnit'=>$carpet_area_unit,
                                     'balcony'=>$balcony,
                                     'kitchen'=>$kitchen,
                                     'totalfloor'=>$total_floor,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_flat_details',$duplex_flat);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_rent_duplex_flat');
   }
   
    function buyer_res_sell_land()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			
        			$landfacing = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rodewide = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$rodewide_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$land_status = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$nature_of_land = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$property_tax = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$mutation = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$covered_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$covred_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Land',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $land = array(
                                     'post_id'=>$result,
                                     'LandMinimumAreaRequired'=> $min_area,
                                     'LandSuperBuildupAreaUnit'=>$min_area_unit,
                                     'LandMaximumAreaRequired'=>$max_area,
                                     'MaximumAreaRequiredUnit'=>$max_area_unit,
                                     'LandFacing'=> $landfacing,
                                     'LandRoadWide'=>$rodewide,
                                     'LandRoadWideUnit'=>$rodewide_unit,
                                     'LandStatus'=>$land_status,
                                     'NatureofLand'=>$nature_of_land,
                                     'PropertyTax'=>$property_tax,
                                     'Mutation'=>$mutation,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupAreaUnit'=>$supper_b_unit,
                                     'CoveredArea'=>$covered_area,
                                     'CoveredAreaUnit'=>$covred_area_unit,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_land_details',$land);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_sale_land');
   }
   
    function buyer_res_rent_land()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			
        			$landfacing = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$rodewide = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$rodewide_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$land_status = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$nature_of_land = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$property_tax = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$mutation = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$covered_area = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$covred_area_unit = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Land',
                                 'residential_commercial'=> 'Residential',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'status'=>1,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $land = array(
                                     'post_id'=>$result,
                                     'LandMinimumAreaRequired'=> $min_area,
                                     'LandSuperBuildupAreaUnit'=>$min_area_unit,
                                     'LandMaximumAreaRequired'=>$max_area,
                                     'MaximumAreaRequiredUnit'=>$max_area_unit,
                                     'LandFacing'=> $landfacing,
                                     'LandRoadWide'=>$rodewide,
                                     'LandRoadWideUnit'=>$rodewide_unit,
                                     'LandStatus'=>$land_status,
                                     'NatureofLand'=>$nature_of_land,
                                     'PropertyTax'=>$property_tax,
                                     'Mutation'=>$mutation,
                                     'SuperBuildupArea'=>$supper_buildup,
                                     'SuperBuildupAreaUnit'=>$supper_b_unit,
                                     'CoveredArea'=>$covered_area,
                                     'CoveredAreaUnit'=>$covred_area_unit,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_land_details',$land);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_residential_rent_land');
   }
    
    // comm
    function buyer_com_sell_office()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$no_of_work_station = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$Ac = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$nature_of_business = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Office',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $office = array(
                            'post_id'=>$result,
                            'NumberofCabin'=> $no_of_cabin,
                            'NumberofWorkStation'=> $no_of_work_station,
                            'MinimumAreaRequired'=> $min_area,
                            'OfficeSuperBuildupAreaUnit'=>$min_area_unit,
                            'MaximumAreaRequired'=>$max_area,
                            'OfficeMaximumAreaRequiredUnit'=>$max_area_unit,
                            'Pentry'=>$pentry,
                            'PentryUsedFor'=>$pentry_user_for,
                            'AC'=>$Ac,
                            'OfficeMinimumFloorHeight'=>$min_floor_hights,
                            'OfficeMaximumFloorHeight'=>$max_floor_hights,
                            'SuperBuildupArea'=> $supper_buildup,
                            'SuperBuildupAreaUnit'=> $supper_b_unit,
                            'CarpetArea'=> $carpet_area,
                            'CarpetAreaUnit'=>$carpet_area_unit,
                            'BuildupArea'=>$bulid_up,
                            'BuildupAreaUnit'=>$build_up_unit,
                             'OfficeBathroom'=>$bathrooms,
                             'OfficeNatureofBusiness'=>$nature_of_business,
                             'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_office_details',$office);
                        
                        
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_sale_office');
   }
    
    function buyer_com_rent_office()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$no_of_work_station = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$min_floor_hights = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_floor_hights = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$pentry_user_for = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$bathrooms_used_for = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$Ac = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$nature_of_business = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$carpet_area = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$carpet_area_unit = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Office',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $office = array(
                            'post_id'=>$result,
                            'NumberofCabin'=> $no_of_cabin,
                            'NumberofWorkStation'=> $no_of_work_station,
                            'MinimumAreaRequired'=> $min_area,
                            'OfficeSuperBuildupAreaUnit'=>$min_area_unit,
                            'MaximumAreaRequired'=>$max_area,
                            'OfficeMaximumAreaRequiredUnit'=>$max_area_unit,
                            'Pentry'=>$pentry,
                            'PentryUsedFor'=>$pentry_user_for,
                            'AC'=>$Ac,
                            'OfficeMinimumFloorHeight'=>$min_floor_hights,
                            'OfficeMaximumFloorHeight'=>$max_floor_hights,
                            'SuperBuildupArea'=> $supper_buildup,
                            'SuperBuildupAreaUnit'=> $supper_b_unit,
                            'CarpetArea'=> $carpet_area,
                            'CarpetAreaUnit'=>$carpet_area_unit,
                            'BuildupArea'=>$bulid_up,
                            'BuildupAreaUnit'=>$build_up_unit,
                            'OfficeBathroom'=>$bathrooms,
                            'OfficeNatureofBusiness'=>$nature_of_business,
                            'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_office_details',$office);
                        
                        
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_rent_office');
   }
   
    function buyer_com_sell_showroom()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$nature_of_business = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$frontage = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$frontage_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$covered_area = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$covered_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$open_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$op_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$roof = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$wideroad = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$wideroad_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$electric_power = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$ep_unit = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$for_bar = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$for_restro = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$heavr_vechical_upto = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'ShopOrShowroom',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $shop = array(
                                 'post_id'=>$result,
                                 'ShopNatureofBusiness'=> $nature_of_business,
                                 'Frontage'=> $frontage,
                                 'FrontageUnit'=> $frontage_unit,
                                 'ShopMinimumAreaRequired'=>$min_area,
                                 'MinimumAreaRequiredUnit'=>$min_area_unit,
                                 'ShopMaximumAreaRequired'=>$max_area,
                                 'ShopMaximumAreaRequiredUnit'=>$max_area_unit,
                                 'SuperBuildupArea'=>$supper_buildup,
                                 'SuperBuildupAreaUnit'=>$supper_b_unit,
                                 'CoveredArea'=>$covered_area,
                                 'CoveredAreaUnit'=>$covered_unit,
                                 'BuildupArea'=>$bulid_up,
                                 'BuildupAreaUnit'=>$build_up_unit,
                                 'OpenArea'=>$open_area,
                                 'OpenAreaUnit'=>$op_area_unit,
                                 'roof'=>$roof,
                                 'Floor'=>$floor,
                                 'Bathroom'=>$bathrooms,
                                 'Pentry'=>$pentry,
                                 'RoadWide'=>$wideroad,
                                 'RoadWideUnit'=>$wideroad_unit,
                                 'ElectricPower'=>$electric_power,
                                 'ElectricPowerUnit'=>$ep_unit,
                                 'AvailableForBar'=>$for_bar,
                                 'ForResturant'=>$for_restro,
                                 'HeavyVehicleParkingUpto'=>$heavr_vechical_upto,
                                 'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_shop_details',$shop);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_sale_shop_showroom');
   }
   
    function buyer_com_rent_showroom()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$nature_of_business = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$frontage = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$frontage_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$min_area = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$min_area_unit = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$max_area_unit = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$supper_buildup = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$supper_b_unit = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$covered_area = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$covered_unit = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$bulid_up = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$build_up_unit = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$open_area = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$op_area_unit = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$roof = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$floor = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$wideroad = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$wideroad_unit = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$electric_power = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$ep_unit = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$for_bar = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$for_restro = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$heavr_vechical_upto = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(62,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'ShopOrShowroom',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $shop = array(
                                 'post_id'=>$result,
                                 'ShopNatureofBusiness'=> $nature_of_business,
                                 'Frontage'=> $frontage,
                                 'FrontageUnit'=> $frontage_unit,
                                 'ShopMinimumAreaRequired'=>$min_area,
                                 'MinimumAreaRequiredUnit'=>$min_area_unit,
                                 'ShopMaximumAreaRequired'=>$max_area,
                                 'ShopMaximumAreaRequiredUnit'=>$max_area_unit,
                                 'SuperBuildupArea'=>$supper_buildup,
                                 'SuperBuildupAreaUnit'=>$supper_b_unit,
                                 'CoveredArea'=>$covered_area,
                                 'CoveredAreaUnit'=>$covered_unit,
                                 'BuildupArea'=>$bulid_up,
                                 'BuildupAreaUnit'=>$build_up_unit,
                                 'OpenArea'=>$open_area,
                                 'OpenAreaUnit'=>$op_area_unit,
                                 'roof'=>$roof,
                                 'Floor'=>$floor,
                                 'Bathroom'=>$bathrooms,
                                 'Pentry'=>$pentry,
                                 'RoadWide'=>$wideroad,
                                 'RoadWideUnit'=>$wideroad_unit,
                                 'ElectricPower'=>$electric_power,
                                 'ElectricPowerUnit'=>$ep_unit,
                                 'AvailableForBar'=>$for_bar,
                                 'ForResturant'=>$for_restro,
                                 'HeavyVehicleParkingUpto'=>$heavr_vechical_upto,
                                 'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_shop_details',$shop);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_rent_shop_showroom');
   }
    
    function buyer_com_sell_warehouse()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			
        			$supperbuildup = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$supperb_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$buildup = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$buildup_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$min_coiverd = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$min_c_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$max_c = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_c_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$min_open = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$min_o_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$max_open = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$max_o_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$min_floor = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$max_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$roof = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$roadwide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$road_w_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$used_for = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$b_used_for = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Warehouse',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $warehouse = array(
                             'post_id'=>$result,
                             'WarehouseRoof'=>$roof,
                             'WarehouseRoadWide'=>$roadwide,
                             'WarehouseRoadWideUnit'=>$road_w_unit,
                             'WarehouseMinimumCoveredArea'=>$min_coiverd,
                             'WarehouseMinimumOpenArea'=>$min_open,
                             'WarehouseMinimumCoveredAreaUnit'=>$min_c_unit,
                             'WarehouseMinimumOpenAreaUnit'=>$min_o_unit,
                             'WarehouseMaximumOpenArea'=>$max_open,
                             'WarehouseMaximumCoveredAreaUnit'=>$max_c_unit,
                             'WarehouseMaximumOpenAreaUnit'=>$max_o_unit,
                             'WarehouseMaximumCoveredArea'=>$max_c,
                             'WarehouseHeavyVehicleParkingUpto'=>$vechicel_parking_upto,
                             'MinimumFloor'=>$min_floor,
                             'MaximumFloor'=>$max_floor,
                             'SuperBuildupArea'=>$supperbuildup,
                             'SuperBuildupAreaUnit'=>$supperb_unit,
                             'BuildupArea'=>$buildup,
                             'BuildupAreaUnit'=>$buildup_unit,
                             'NumberofCabin'=>$no_of_cabin,
                             'NumberofWorkStation'=>$no_of_workstations,
                             'Pentry'=>$pentry,
                             'PentryUsedFor'=>$used_for,
                             'Bathroom'=>$bathrooms,
                             'roof' => $roof,
                             'heavy_p_upto' => $heavy_parking_uptp,
                             'bathroom_used_for' => $b_used_for,
                             'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_warehouse_details',$warehouse);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_sale_warehouse');
   }
   
    function buyer_com_rent_warehouse()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			
        			$supperbuildup = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$supperb_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$buildup = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$buildup_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$min_coiverd = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$min_c_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$max_c = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_c_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$min_open = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$min_o_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$max_open = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$max_o_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$min_floor = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$max_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$roof = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$roadwide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$road_w_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$used_for = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$b_used_for = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Warehouse',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $warehouse = array(
                             'post_id'=>$result,
                             'WarehouseRoof'=>$roof,
                             'WarehouseRoadWide'=>$roadwide,
                             'WarehouseRoadWideUnit'=>$road_w_unit,
                             'WarehouseMinimumCoveredArea'=>$min_coiverd,
                             'WarehouseMinimumOpenArea'=>$min_open,
                             'WarehouseMinimumCoveredAreaUnit'=>$min_c_unit,
                             'WarehouseMinimumOpenAreaUnit'=>$min_o_unit,
                             'WarehouseMaximumOpenArea'=>$max_open,
                             'WarehouseMaximumCoveredAreaUnit'=>$max_c_unit,
                             'WarehouseMaximumOpenAreaUnit'=>$max_o_unit,
                             'WarehouseMaximumCoveredArea'=>$max_c,
                             'WarehouseHeavyVehicleParkingUpto'=>$vechicel_parking_upto,
                             'MinimumFloor'=>$min_floor,
                             'MaximumFloor'=>$max_floor,
                             'SuperBuildupArea'=>$supperbuildup,
                             'SuperBuildupAreaUnit'=>$supperb_unit,
                             'BuildupArea'=>$buildup,
                             'BuildupAreaUnit'=>$buildup_unit,
                             'NumberofCabin'=>$no_of_cabin,
                             'NumberofWorkStation'=>$no_of_workstations,
                             'Pentry'=>$pentry,
                             'PentryUsedFor'=>$used_for,
                             'Bathroom'=>$bathrooms,
                             'roof' => $roof,
                             'heavy_p_upto' => $heavy_parking_uptp,
                             'bathroom_used_for' => $b_used_for,
                             'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_warehouse_details',$warehouse);
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_rent_warehouse');
   }
   
    function buyer_com_sell_factory()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			
        			$supperbuildup = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$supperb_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$buildup = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$buildup_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$min_coiverd = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$min_c_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$max_c = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_c_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$min_open = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$min_o_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$max_open = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$max_o_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$min_floor = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$max_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$roof = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$roadwide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$road_w_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$used_for = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$b_used_for = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Factory',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $factory = array(
                                     'post_id'=>$result,
                                     'MinimumOpenArea'=>$min_open,
                                     'MinimumCoveredArea'=>$min_coiverd,
                                     'MinimumOpenAreaUnit'=>$min_o_unit,
                                     'MinimumCoveredAreaUnit'=>$min_c_unit,
                                     'roof'=>$roof,
                                     'ElectricPower'=>$min_floor,
                                     'ElectricPowerUnit'=>$max_floor,
                                     'NatureofBusiness'=>$vechicel_parking_upto,
                                     'MaximumOpenArea'=>$max_open,
                                     'MaximumCoveredArea'=>$max_c,
                                     'MaximumOpenAreaUnit'=>$max_o_unit,
                                     'MaximumCoveredAreaUnit'=>$max_c_unit,
                                     
                                     'SuperBuildupArea'=>$supperbuildup,
                                     'SuperBuildupAreaUnit'=>$supperb_unit,
                                     'BuildupArea'=>$buildup,
                                     'BuildupAreaUnit'=>$buildup_unit,
                                     
                                     'RoadWide'=>$roadwide,
                                     'RoadWideUnit'=>$road_w_unit,
                                     'HeavyVehicleParkingUpto'=>$heavy_parking_uptp,
                                     
                                     'NumberofCabin'=>$no_of_cabin,
                                     'NumberofWorkStation'=>$no_of_workstations,
                                     'Pentry'=>$pentry,
                                     'PentryUsedFor'=>$used_for,
                                     'Bathroom'=>$bathrooms,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_factory_details',$factory);             
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_sale_factory');
   }
   
    function buyer_com_rent_factory()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			$furnished_status = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			
        			$supperbuildup = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$supperb_unit = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$buildup = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$buildup_unit = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$min_coiverd = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$min_c_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$max_c = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$max_c_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$min_open = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$min_o_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$max_open = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$max_o_unit = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$vechicel_parking_upto = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$min_floor = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			$max_floor = $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(28,$cl)->getValue() : '';
        			$roof = $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(29,$cl)->getValue() : '';
        			$heavy_parking_uptp = $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(30,$cl)->getValue() : '';
        			$roadwide = $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(31,$cl)->getValue() : '';
        			$road_w_unit = $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(32,$cl)->getValue() : '';
        			$no_of_cabin = $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(33,$cl)->getValue() : '';
        			$no_of_workstations = $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(34,$cl)->getValue() : '';
        			$pentry = $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(35,$cl)->getValue() : '';
        			$used_for = $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(36,$cl)->getValue() : '';
        			$bathrooms = $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(37,$cl)->getValue() : '';
        			$b_used_for = $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(38,$cl)->getValue() : '';
        			$o_parking = $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(39,$cl)->getValue() : '';
        			$c_parking = $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(40,$cl)->getValue() : '';
        			$b_barking = $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(41,$cl)->getValue() : '';
        			$lift_parking = $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(42,$cl)->getValue() : '';
        			$two_wiheerl = $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(43,$cl)->getValue() : '';
        			$power_bkups = $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(44,$cl)->getValue() : '';
        			$services_lift = $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(45,$cl)->getValue() : '';
        			$banquite_hall = $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(46,$cl)->getValue() : '';
        			$gym = $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(47,$cl)->getValue() : '';
        			$v_parking = $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(48,$cl)->getValue() : '';
        			$intercom = $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(49,$cl)->getValue() : '';
        			$cctv = $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(50,$cl)->getValue() : '';
        			$swimming_pool = $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(51,$cl)->getValue() : '';
        			$cloub_house = $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(52,$cl)->getValue() : '';
        			$servent_room = $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(53,$cl)->getValue() : '';
        			$lift = $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(54,$cl)->getValue() : '';
        			$wifi = $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(55,$cl)->getValue() : '';
        			$community_hall = $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(56,$cl)->getValue() : '';
        			$indoor_games = $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(57,$cl)->getValue() : '';
        			$outdoor_games = $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(58,$cl)->getValue() : '';
        			$gas = $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(59,$cl)->getValue() : '';
        			$park = $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(60,$cl)->getValue() : '';
        			$security = $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(61,$cl)->getValue() : '';

                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Factory',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                                 'OpenParking'=>$o_parking,
                                 'CoveredParking'=>$c_parking,
                                 'Basement'=>$b_barking,
                                 'LiftParking'=>$lift_parking,
                                 'TwoWheeler'=>$two_wiheerl,
                                 'status'=>1,
                                 'PowerBackup'=>(!empty($power_bkups)) ? 1 : 0,
                                  'ServiveLift'=>(!empty($services_lift)) ? 1 : 0,
                                  'BanquetHall'=>(!empty($banquite_hall)) ? 1 : 0,
                                  'GYM'=>(!empty($gym)) ? 1 : 0,
                                  'VisitorParking'=>(!empty($v_parking)) ? 1 : 0,
                                  'Intercom'=>(!empty($intercom)) ? 1 : 0,
                                  'CCTV'=>(!empty($cctv)) ? 1 : 0,
                                  'SwimmingPool'=>(!empty($swimming_pool)) ? 1 : 0,
                                  'CloubHouse'=>(!empty($cloub_house)) ? 1 : 0,
                                  'SarvantRoom'=>(!empty($servent_room)) ? 1 : 0,
                                  'Lift'=>(!empty($lift)) ? 1 : 0,
                                  'WIFI'=>(!empty($wifi)) ? 1 : 0,
                                  'CommunityHall'=>(!empty($community_hall)) ? 1 : 0,
                                  'IndoorGame'=>(!empty($indoor_games)) ? 1 : 0,
                                  'OutDoorGame'=>(!empty($outdoor_games)) ? 1 : 0,
                                  'GasPipeLine'=>(!empty($gas)) ? 1 : 0,
                                  'Park'=>(!empty($park)) ? 1 : 0,
                                  'Security'=>(!empty($security)) ? 1 : 0,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $factory = array(
                                     'post_id'=>$result,
                                     'MinimumOpenArea'=>$min_open,
                                     'MinimumCoveredArea'=>$min_coiverd,
                                     'MinimumOpenAreaUnit'=>$min_o_unit,
                                     'MinimumCoveredAreaUnit'=>$min_c_unit,
                                     'roof'=>$roof,
                                     'ElectricPower'=>$min_floor,
                                     'ElectricPowerUnit'=>$max_floor,
                                     'NatureofBusiness'=>$vechicel_parking_upto,
                                     'MaximumOpenArea'=>$max_open,
                                     'MaximumCoveredArea'=>$max_c,
                                     'MaximumOpenAreaUnit'=>$max_o_unit,
                                     'MaximumCoveredAreaUnit'=>$max_c_unit,
                                     
                                     'SuperBuildupArea'=>$supperbuildup,
                                     'SuperBuildupAreaUnit'=>$supperb_unit,
                                     'BuildupArea'=>$buildup,
                                     'BuildupAreaUnit'=>$buildup_unit,
                                     
                                     'RoadWide'=>$roadwide,
                                     'RoadWideUnit'=>$road_w_unit,
                                     'HeavyVehicleParkingUpto'=>$heavy_parking_uptp,
                                     
                                     'NumberofCabin'=>$no_of_cabin,
                                     'NumberofWorkStation'=>$no_of_workstations,
                                     'Pentry'=>$pentry,
                                     'PentryUsedFor'=>$used_for,
                                     'Bathroom'=>$bathrooms,
                                     'created'=>date('Y-m-d H:i:s'));
                        $res = $this->Common_model->insert_data('requirement_factory_details',$factory);             
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_rent_factory');
   }
   
    function buyer_com_sell_land()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			
        			$min_area = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$min_unit = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$max_aera_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$land_facing = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$roadewat = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$roadway_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$supper_build = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$supper_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$coverd_area = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$covered_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$land_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$nature_of_land = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$property_tax = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$mutauation = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Land',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Sell',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                           
                                 'status'=>1,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $land = array(
                                     'post_id'=>$result,
                                     'LandMinimumAreaRequired'=> $min_area,
                                     'LandSuperBuildupAreaUnit'=> $min_unit,
                                     'LandMaximumAreaRequired'=>$max_area,
                                     'MaximumAreaRequiredUnit'=>$max_aera_unit,
                                     'SuperBuildupArea'=>$supper_build,
                                     'SuperBuildupAreaUnit'=>$supper_unit,
                                     'CoveredArea'=> $coverd_area,
                                     'CoveredAreaUnit'=> $covered_unit,
                                     'LandFacing'=> $land_facing,
                                     'LandRoadWide'=> $roadewat,
                                     'LandRoadWideUnit'=>$roadway_unit,
                                     'LandStatus'=>$land_status,
                                     'NatureofLand'=>$nature_of_land,
                                     'PropertyTax'=>$property_tax,
                                     'Mutation'=>$mutauation,
                                     'created'=>date('Y-m-d H:i:s'));
                         $res = $this->Common_model->insert_data('requirement_land_details',$land);
                         
                        
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_sale_land');
    }
    
    function buyer_com_rent_land()
    {
       $this->load->library('upload');
        $this->load->library('PHPReport');
        $this->load->helper('download');
    	$configUpload['upload_path'] = FCPATH.'Uploads/excels/lead_partners/';
    	$configUpload['allowed_types'] = 'xls|xlsx';
    	$configUpload['max_size'] = '0';
    	$this->upload->initialize($configUpload);
    	$this->upload->do_upload('lead_partner');
    	
    	$upload_data = $this->upload->data(); //Returns array of containing all of the data related to the file you uploaded.
    	$file_name = $upload_data['file_name']; //uploded file name
    	$extension=$upload_data['file_ext'];    // uploded file extension
    	$objReader =PHPExcel_IOFactory::createReader('Excel2007');
    	$objReader->setReadDataOnly(false);
    	$objPHPExcel=PHPExcel_IOFactory::load(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
    // 	pre($objPHPExcel);
    	foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) 
    	{
    		$worksheet_index=$objPHPExcel->getIndex($worksheet);
			$highestRow=$objPHPExcel->setActiveSheetIndex($worksheet_index)->getHighestRow();
// 			pre($highestRow);
			$objWorksheet = $objPHPExcel->getActiveSheet($worksheet_index);
			if($highestRow > 0)
			{
		        for($cl=2;$cl<=$highestRow;$cl++)
		        {
        			$name = $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(0,$cl)->getValue() : '';
        			$mobile = $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(1,$cl)->getValue() : '';
        			$mobile1 = $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(2,$cl)->getValue() : '';
        			$phone = $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(3,$cl)->getValue() : '';
        			$email = $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(4,$cl)->getValue() : '';
        			$state = $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(5,$cl)->getValue() : '';
        			$city = $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(6,$cl)->getValue() : '';
        			$location = $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(7,$cl)->getValue() : '';
        			$complex = $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(8,$cl)->getValue() : '';
        			$ready_to_move = $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(9,$cl)->getValue() : '';
        			$possession_date = date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) != NULL ? date('Y-m-d', PHPExcel_Shared_Date::ExcelToPHP($objWorksheet->getCellByColumnAndRow(10,$cl)->getValue())) : '';
        			$min_price = $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(11,$cl)->getValue() : '';
        			$max_price = $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(12,$cl)->getValue() : '';
        			
        			$min_area = $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(13,$cl)->getValue() : '';
        			$min_unit = $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(14,$cl)->getValue() : '';
        			$max_area = $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(15,$cl)->getValue() : '';
        			$max_aera_unit = $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(16,$cl)->getValue() : '';
        			$land_facing = $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(17,$cl)->getValue() : '';
        			$roadewat = $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(18,$cl)->getValue() : '';
        			$roadway_unit = $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(19,$cl)->getValue() : '';
        			$supper_build = $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(20,$cl)->getValue() : '';
        			$supper_unit = $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(21,$cl)->getValue() : '';
        			$coverd_area = $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(22,$cl)->getValue() : '';
        			$covered_unit = $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(23,$cl)->getValue() : '';
        			$land_status = $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(24,$cl)->getValue() : '';
        			$nature_of_land = $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(25,$cl)->getValue() : '';
        			$property_tax = $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(26,$cl)->getValue() : '';
        			$mutauation = $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() != NULL ? $objWorksheet->getCellByColumnAndRow(27,$cl)->getValue() : '';
        			
                    $maxid = $this->Common_model->selectmaxid('post_id', array(), 'post_requirement');
                    $nozero = 7 - strlen($maxid);
                    $zeros = '';
                    for($j=0;$j<$nozero;$j++){$zeros .= '0';}
                    $lead_id = $this->RandomString().$zeros;
                    $lead_id = 'REQ'.$zeros.($maxid+1);

                    $insert_data = array('user_id'=>$this->session->userdata('admin_id'),
                                 'user_type'=> $this->session->userdata('user_type'),
                                 'lead_id'=>$lead_id,
                                 
                                 'residential'=> 'Land',
                                 'residential_commercial'=> 'Commercial',
                                 'rent_sell'=> 'Rent',
                                 
                                 'name'=> $name,
                                 'mobile'=> $mobile,
                                 'mobile2'=> $mobile1,
                                 'phone'=> $phone,
                                 'email'=> $email,
                                 'state'=> $state,
                                 'city'=> $city,
                                 'location'=>!empty($location) ? $location : '',
                                 'MinimumRent'=> $min_price,
                                 'MaximumRent'=> $max_price,
                                 'FurnishedStatus'=>!empty($furnished_status) ? $furnished_status : '',
                                 'ComplexSoceityBuilding'=>!empty($complex) ? $complex : '',
                                 'section'=>!empty($ready_to_move) ? 'ReadyToMove' : '',
                                 'PossessionDate'=>($possession_date != '') ? date('Y-m-d H:i:s', strtotime($possession_date)) : NULL,
                           
                                 'status'=>1,
                                 'created'=>date('Y-m-d H:i:s'));
                    $result = $this->Common_model->insert_data('post_requirement',$insert_data);
        			
                    if($result)
                    {
                        $land = array(
                                     'post_id'=>$result,
                                     'LandMinimumAreaRequired'=> $min_area,
                                     'LandSuperBuildupAreaUnit'=> $min_unit,
                                     'LandMaximumAreaRequired'=>$max_area,
                                     'MaximumAreaRequiredUnit'=>$max_aera_unit,
                                     'SuperBuildupArea'=>$supper_build,
                                     'SuperBuildupAreaUnit'=>$supper_unit,
                                     'CoveredArea'=> $coverd_area,
                                     'CoveredAreaUnit'=> $covered_unit,
                                     'LandFacing'=> $land_facing,
                                     'LandRoadWide'=> $roadewat,
                                     'LandRoadWideUnit'=>$roadway_unit,
                                     'LandStatus'=>$land_status,
                                     'NatureofLand'=>$nature_of_land,
                                     'PropertyTax'=>$property_tax,
                                     'Mutation'=>$mutauation,
                                     'created'=>date('Y-m-d H:i:s'));
                         $res = $this->Common_model->insert_data('requirement_land_details',$land);
                         
                        
                    }
		        }
    		}
    	}
    	unlink(FCPATH.'Uploads/excels/lead_partners/'.$file_name);
        redirect('property/buyer_commercial_rent_land');
    }
   
}